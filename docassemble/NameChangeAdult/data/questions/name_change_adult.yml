metadata:
  title: Name change for an adult
  short title: Name change for an adult
  comment: This program helps you ask a judge to change your name.
  authors:
    - Matt Newsted
---
include:
  - docassemble.AssemblyLine:assembly_line.yml
  - docassemble.ALToolbox:phone-number-validation.yml  
  - docassemble.ILAO:ilao-interview-framework.yml
  - docassemble.ILAO:shared-basic-questions.yml
---
objects:
  - users: ALPeopleList.using(there_are_any=True)
  - users[i].new: ALIndividual
  - users[i].birthplace: ALAddress
  - divorce_location: ALAddress
  - users[i].convictions: DAList.using(object_type=Thing, there_are_any=True)
  - orders: DAList.using(object_type=Thing, complete_attribute='complete', there_are_any=True)
  - court_list: ALCourtLoader.using(file_name='docassemble.ILAO:data/sources/il_courts.xlsx')
---
code: |
  al_form_type = 'existing_case'
  ilao_easy_form_title = "Name change for an adult"
  ilao_easy_form_url = "https://www.illinoislegalaid.org/legal-information/name-change-adult"
  form_name = "Request for Name Change"
  github_user = 'IllinoisLegalAidOnline'
  github_repo_name = 'docassemble-NameChangeAdult'
  allowed_courts = ['Circuit']
  interview_type = 'adult'
  # child_notice variable used in child name change program
  child_notice_would_be_published = False
---
# Road map
sections:
  - section_intro: Start
  - section_about_you: About you
  - section_spouse: About your spouse (optional)
  - section_notice: Notice and publication
  - section_filing_details: Filing details
  - section_download: Download  
---
# interview order block
mandatory: True
code: |
  nav.set_section('section_intro')
  sees_nav_bar
  how_to_use
  set_progress(5)
  whats_next
  accept_terms

  set_progress(15)
  nav.set_section('section_about_you')
  users[0].birthdate
  if users[0].age_in_years() < 18:
    not_adult
  users[0].birthplace.city
  if users[0].is_resident == True:
    if date_difference(starting=users[0].resident_date , ending=today() ).years < 0.5:
      not_resident
  else:
    not_resident
  
  users[0].name.first
  users[0].new.name.first
  users[0].criminal_history_intro
  users[0].pending_arrests
  users[0].pending_charges
  users[0].misdemeanors
  users[0].felonies
  users[0].registry
  if users[0].registry and users[0].registry_exceptions.all_false():
    registry_kickout
  if users[0].registry and users[0].registry_exceptions.any_true():
    registry_notification
  users[0].id_theft
  if users[0].felonies or users[0].registry or users[0].id_theft:
    users[0].conviction_intro
  	users[0].convictions.gather()  

  set_progress(50)
  nav.set_section('section_spouse')
  if change_spouse_name == "Yes":
    users[1].birthdate
    if users[1].age_in_years() < 16:
      spouse_not_adult_kickout
      spouse_adult_check
    else:
      users[1].birthplace.city
      if users[1].is_resident == True:
        if date_difference(starting=users[1].resident_date , ending=today() ).years < 0.5:
          spouse_not_resident_kickout
          spouse_resident_check
        else:
          users[1].name.first
          users[1].new.name.first
          users[1].criminal_history_intro 
          users[1].pending_arrests
          users[1].pending_charges
          users[1].misdemeanors
          users[1].felonies
          users[1].registry
          if users[1].registry and users[1].registry_exceptions.all_false():
            spouse_registry_kickout
            spouse_registry_eligibility_check
          else:
            if users[1].registry and users[1].registry_exceptions.any_true():
              registry_notification
            users[1].id_theft
            if users[1].felonies or users[1].registry or users[1].id_theft:
              users[1].conviction_intro
          	  users[1].convictions.gather()  
      else:
        spouse_not_resident_kickout
        spouse_resident_check
         
  
  set_progress(75)
  nav.set_section('section_notice')
  notice_intro
  if users[0].after_divorce == True:
    divorce_location.state
  if users[0].after_divorce == False or change_spouse_name == "Yes": # publication may be required
    if request_waiver == True:
      if waiver_reason['order'] == True:
        if protective_order.any_true():
          orders.gather()
      hardship_text

  if users[0].after_divorce == False:
    if request_waiver == False:
      publication_intro
      publication_placeholder

  # IF PUBLICATION do we want to ask if they already have hearing information from court clerk? date, time, in person (courtroom) or remote (phone, website, log-in information). 
  # do you know this now?
  # in person or remote?
  # court hearing date, time, courtroom
  # if remote - phone, website, login info

  set_progress(90)
  nav.set_section('section_filing_details')
  if trial_court_index == -1:
    cook_district
    if cook_district == "15":
      district_1
  courthouse_info
  hide_address
  users[0].address.address
  users[0].phone_number
  if users[0].email_notice == True:
    users[0].email
  e_signature
  if change_spouse_name == "Yes":
    users[1].address.address
    users[1].phone_number
    if users[1].email_notice == True:
      users[1].email
    e_signature_spouse

  set_progress(100)
  nav.set_section('section_download')
  get_docs_screen
---
id: welcome
question: |
  Name change for an adult
subquestion: |
  Welcome to Illinois Legal Aid Online's **Name change for an adult** Easy Form.

  This program helps you make the forms to request a legal name change in Illinois. If you have a spouse, they can request a name change at the same time on your forms.
  
  To learn more, read ILAO's article about [**Name change basics**](https://www.illinoislegalaid.org/node/29921).
field: sees_nav_bar
---
id: instructions
continue button field: how_to_use
question: |
  Instructions
subquestion: |
  To change your name in Illinois you must: 

  * Be at least 18 years old, and 
  * Have lived in Illinois for at least 6 months.
  
  You will also need details about your criminal history. If your spouse is requesting a name change, they must also meet these requirements.

  Set aside 10 to 15 minutes to finish this program. You can log in and save your work to return to later. 
 
  ${ collapse_template(help_example) }  

  Click on **{green words}** to learn what they mean. Some pages have a question mark in a circle ${ fa_icon("question-circle", color_css="#0dcaf0" ) } that helps explain things.
---
template: help_example
subject: |
  **You can click sections like this to show more information.**
content: |  
  This is an example of help. Click again to hide.
---
id: whats next
continue button field: whats_next
question: |
  After you finish this program
subquestion: |
  After you download your forms, you must file them with the court. This program **does not** file your forms for you.
  
  When you file your forms, the court clerk will give you a court date. Usually, you have to publish notice of your name change in a newspaper where you live for 3 weeks. However, if publishing notice would be a hardship to you, including risking your health or safety, you can ask the judge to skip that step. This program will help you make the forms you need either way.
  
  To learn more, read the "How to Change Your Name" instructions you can download at the end of this program. 
---
id: birthdate
question: |
  When were you born?
fields:
  - Date of birth: users[0].birthdate
    datatype: BirthDate
    alMax: ${ today().format("yyyy-MM-dd") }
---
id: birth place
question: |
  Where were you born?
fields:
  - Were you born in the United States?: users[0].in_america
    datatype: yesnoradio
    default: True
  - City: users[0].birthplace.city
  - County: users[0].birthplace.county
    show if: 
      variable: users[0].in_america
      is: True
  - State: users[0].birthplace.state
    show if: 
      variable: users[0].in_america
      is: True
    code: |
      states_list() 
  - County (if applicable), and State or province: users[0].birthplace.intl_text
    help: |
      List the county (if applicable) and list the state or province, separated by a comma.
    show if: 
      variable: users[0].in_america
      is: False
  - Country (outside US): users[0].birthplace.country
    show if: 
      variable: users[0].in_america
      is: False    
    
---
id: spouse birthdate
question: |
  When was your spouse born?
fields:
  - Date of birth: users[1].birthdate
    datatype: BirthDate
    alMax: ${ today().format("yyyy-MM-dd") }
---
id: spouse birth place
question: |
  Where was your spouse born?
fields:
  - Were they born in the United States?: users[1].in_america
    datatype: yesnoradio
    default: True
  - City: users[1].birthplace.city
  - County: users[1].birthplace.county
    show if: 
      variable: users[1].in_america
      is: True
  - State: users[1].birthplace.state
    show if: 
      variable: users[1].in_america
      is: True
    code: |
      states_list() 
  - County (if applicable), and State or province: users[1].birthplace.intl_text
    help: |
      List the county (if applicable) and list the state or province, separated by a comma.
    show if: 
      variable: users[1].in_america
      is: False
  - Country (outside US): users[1].birthplace.country
    show if: 
      variable: users[1].in_america
      is: False    
    
---
id: user continuous illinois residence
question: |
  Have you lived in Illinois for the past 6 months?
subquestion: |
  Answering **Yes** means that you have lived in Illinois for 6 months without taking a break to live in another state or country.
fields:
  - no label: users[0].is_resident
    datatype: yesnoradio
---
id: user resident date
question: |
  When did you start living in Illinois?
fields:
  - Lived in Illinois since: users[0].resident_date
    datatype: BirthDate
    alMin: ${ users[0].birthdate.format("yyyy-MM-dd") }
    alMax: ${ today().format("yyyy-MM-dd") }
---
id: spouse continuous illinois residence
question: |
  Has your spouse lived in Illinois for the past 6 months?
subquestion: |
  Answering **Yes** means that your spouse has lived in Illinois without taking a break to live in another state or country.
fields:
  - no label: users[1].is_resident
    datatype: yesnoradio
---
id: spouse resident date
question: |
  When did your spouse start living in Illinois?
fields:
  - Lived in Illinois since: users[1].resident_date
    datatype: BirthDate
    alMax: ${ today().format("yyyy-MM-dd") }

---
id: date debug
continue button field: date_debug
question: |
  Date debug
subquestion: |
  Today: ${format_date( today() )}
  
  Residency date: ${format_date( users[0].resident_date )}
  
  Resident at least 6 months: ${ date_difference(starting=users[0].resident_date , ending=today() ).years > 0.5 }


---
id: not illinois resident
event: not_resident
question: |
  Sorry
subquestion: |
  This program is only for people who have lived in Illinois continuously for 6 months.

  Click **Back** if you made a mistake. Or you can talk with a lawyer to discuss your options. 

  You can use the [**Legal Services Corporation website**](https://www.lsc.gov/about-lsc/what-legal-aid/get-legal-help) to find a legal aid organization in another state. Or you can use **[Get Legal Help](https://www.illinoislegalaid.org/get-legal-help)** to find free or low-cost legal services in your area.
buttons:
  - Exit: exit
  - Restart: restart
---
id: spouse not illinois resident
continue button field: spouse_not_resident_kickout
question: |
  Sorry
subquestion: |
  Your spouse must have lived in Illinois continuously for 6 months.
  
  This program cannot make name change forms for your spouse. You can talk with a lawyer to discuss your options. You can use the [**Legal Services Corporation website**](https://www.lsc.gov/about-lsc/what-legal-aid/get-legal-help) to find a legal aid organization in another state. Or you can use **[Get Legal Help](https://www.illinoislegalaid.org/get-legal-help)** to find free or low-cost legal services in your area.
  
  Click **Back** if you made a mistake or click **Next** to make the forms for your name change.
---
depends on: 
  - users[1].is_resident
  - users[1].resident_date
code: |
  if change_spouse_name == "Yes" and (users[1].is_resident == False or date_difference(starting=users[1].resident_date , ending=today() ).years < 0.5):
    change_spouse_name = "No"
  spouse_resident_check = True
  
---
id: not adult
event: not_adult
question: |
  Sorry
subquestion: |
  This program is only for people who are age 18 or older.
  
  If you want to change the name of someone under 18, you can use ILAO's [**Name change for a child**](https://www.illinoislegalaid.org/legal-information/name-change-child) Easy Form.
  
  Click **Back** if you made a mistake. Or you can talk with a lawyer to discuss your options. Use **[Get Legal Help](https://www.illinoislegalaid.org/get-legal-help)** to find free or low-cost legal services in your area.
buttons:
  - Exit: exit
  - Restart: restart
---
id: spouse not adult
continue button field: spouse_not_adult_kickout
question: |
  Sorry
subquestion: |
  Your spouse must be age 16 or older to request a name change.
  
  This program cannot make name change forms for your spouse. You can talk with a lawyer to discuss your options. Use **[Get Legal Help](https://www.illinoislegalaid.org/get-legal-help)** to find free or low-cost legal services in your area.
  
  Click **Back** if you made a mistake or click **Next** to make the forms for your name change.
---
depends on: users[1].birthdate
code: |
  if change_spouse_name == "Yes" and users[1].age_in_years() < 16:
    change_spouse_name = "No"
  spouse_adult_check = True
---
id: your current legal name
sets:
    - users[0].name.first
    - users[0].name.last
    - users[0].name.middle
    - users[0].name.suffix
question:  |
  What is your current legal name?
subquestion: |
  Enter your complete legal name as it appears on your birth certificate to avoid issues or delays.

  You can enter your new name on the next screen.
fields:
  - code: |
      users[0].name_fields()
---
id: your spouse's current legal name
sets:
    - users[1].name.first
    - users[1].name.last
    - users[1].name.middle
    - users[1].name.suffix
question:  |
  What is your spouse's current legal name?
subquestion: |
  Enter your spouse's complete legal name as it appears on their birth certificate to avoid issues or delays.

  You can enter your spouse's new name on the next screen.
fields:
  - code: |
      users[1].name_fields()


---
id: your new name
sets:
    - users[0].new.name.first
    - users[0].new.name.last
    - users[0].new.name.middle
    - users[0].new.name.suffix
question:  |
  What do you want your name to be changed to?
fields:
  - code: |
      users[0].new.name_fields()
---
id: your spouse's new name
sets:
    - users[1].new.name.first
    - users[1].new.name.last
    - users[1].new.name.middle
    - users[1].new.name.suffix
question:  |
  What does your spouse want their name to be changed to?
fields:
  - code: |
      users[1].new.name_fields()


---
id: name change after divorce
question: |
  Are you changing your name as a result of a divorce?
subquestion: |
  If you have a divorce judgment and want to change your name to a former or maiden name, you do not need to publish notice.
  
  If your divorce judgment gives you permission to return to using your former or maiden name, you do not need to file a separate name change request. The divorce judgment should work as an effective court order to change identification.
fields:
  - no label: users[0].after_divorce
    datatype: yesnoradio
---
id: divorce details
question: |
  Divorce details
subquestion: |
  Enter information about the divorce judgment.
fields:
  - Date of divorce judgment: divorce_date
    datatype: date
    max: ${ today().format("yyyy-MM-dd") }
  - Was the court that ordered the divorce in the United states?: divorce_in_us
    datatype: yesnoradio
  - County: divorce_location.county
    show if:
      variable: divorce_in_us
      is: True
  - State: divorce_location.state
    code: states_list()
    default: IL    
    show if:
      variable: divorce_in_us
      is: True
  - County (enter the city if there is no county): divorce_location.county
    show if:
      variable: divorce_in_us
      is: False
  - State or province: divorce_location.state
    show if:
      variable: divorce_in_us
      is: False
---
id: also change spouse name question
question: |
  Does your spouse also want to change their name?
subquestion: |
  Your spouse can ask for a legal name change on the same forms.
fields:
  - no label: change_spouse_name
    datatype: radio
    choices:
      - Yes: Yes
      - No: No
      - I do not have a spouse.: Does not apply

---
id: criminal history intro
generic object: ALPeopleList
continue button field: x[i].criminal_history_intro
question: |
  Criminal history
subquestion: |
  % if interview_type == 'adult':
    % if i == 0:
    To request a name change in Illinois, you need to tell the court about any criminal history you may have.
    % else:
    To request a name change in Illinois, your spouse needs to tell the court about any criminal history they may have.
    % endif
  % else:
    To request a name change for a child, you must tell the court about any criminal history the child may have.
  % endif
  
  Having any criminal history does not prevent a person from getting a legal name change. Only certain offenses can affect the name change request. The next screens will guide you through the process.
---
id: pending arrests
generic object: ALPeopleList
question: |
  % if interview_type == 'adult':
    % if i == 0:
    Do you have any arrests for which charges have not been filed?
    % else:
    Does your spouse have any arrests for which charges have not been filed?
    % endif
  % else:
  Does ${x[i].new.name.full(middle='full')} (AKA ${x[i].name.full(middle='full')}) have any arrests for which charges have not been filed?
  % endif
subquestion: |
  If you were arrested but did not go to court or see a judge, then you were probably not charged with a crime. That means the arrest is pending.
fields:
  - no label: x[i].pending_arrests
    datatype: yesnoradio

---
id: pending charges
generic object: ALPeopleList
question: |
  % if interview_type == 'adult':
    % if i == 0:
    Do you have any pending misdemeanor or felony charges?
    % else:
    Does your spouse have any pending misdemeanor or felony charges?
    % endif
  % else:
  Does ${x[i].new.name.full(middle='full')} (AKA ${x[i].name.full(middle='full')}) have any pending misdemeanor or felony charges?
  % endif
subquestion: |
  % if interview_type == 'adult':
    % if i == 0:
    In other words, do you have any ongoing criminal cases against you for misdemeanor or felony offenses?
    % else:
    In other words, does your spouse have any ongoing criminal cases against them for misdemeanor or felony offenses?
    % endif
  % else:
    In other words, does ${x[i].new.name.full(middle='full')} (AKA ${x[i].name.full(middle='full')}) have any ongoing criminal cases against them for misdemeanor or felony offenses?
  % endif
fields:
  - no label: x[i].pending_charges
    datatype: yesnoradio
---
id: misdemeanors
generic object: ALPeopleList
question: |
  % if interview_type == 'adult':
    % if i == 0:
    Do you have any convictions or were you placed on probation for any misdemeanors?
    % else:
    Does your spouse have any convictions or were they placed on probation for any misdemeanors?
    % endif
  % else:
  Does ${x[i].new.name.full(middle='full')} (AKA ${x[i].name.full(middle='full')}) have any convictions or were they placed on probation for any misdemeanors?
  % endif
subquestion: |
  These can be misdemeanors in Illinois or any other state.
fields:
  - no label: x[i].misdemeanors
    datatype: yesnoradio
  - Were all of these misdemeanors pardoned?: x[i].misdemeanor_pardon
    datatype: yesnoradio
    show if:
      variable: x[i].misdemeanors
      is: True
---
id: felonies
generic object: ALPeopleList
question: |
  % if interview_type == 'adult':
    % if i == 0:
    Do you have any convictions or were you placed on probation for any felonies?
    % else:
    Does your spouse have any convictions or were they placed on probation for any felonies?
    % endif
  % else:
  Does ${x[i].new.name.full(middle='full')} (AKA ${x[i].name.full(middle='full')}) have any convictions or were they placed on probation for any felonies?
  % endif
subquestion: |
  These can be felonies in Illinois or any other state.
fields:
  - no label: x[i].felonies
    datatype: yesnoradio
  - Were all of these felonies pardoned?: x[i].felony_pardon
    datatype: yesnoradio
    show if:
      variable: x[i].felonies
      is: True
---
id: registries
generic object: ALPeopleList
question: |
  % if interview_type == 'adult':
    % if i == 0:
    Do you have any convictions or were you placed on probation for a crime that required you register?
    % else:
    Does your spouse have any convictions or were they placed on probation for a crime that required them to register?
    % endif
  % else:
  Does ${x[i].new.name.full(middle='full')} (AKA ${x[i].name.full(middle='full')}) have any convictions or were they placed on probation for a crime that required them register?
  % endif
subquestion: |
  These include crimes that require registration under the:
  
  * Sex Offender Registration Act
  * Murderer and Violent Offender Against Youth Act, or
  * Arsonist Registration Act.

  % if interview_type == 'adult':
    % if i == 0:
    **Important**: If you were placed on any of these registries and have not been pardoned, **it is a felony to file a petition to change your name** unless one of these exceptions apply:
    % else:
    **Important**: If they were placed on any of these registries and have not been pardoned, **it is a felony to file a petition to change your name** unless one of these exceptions apply:
    % endif
  % else:
  **Important**: If they were placed on any of these registries and have not been pardoned, **it is a felony to file a petition to change your name** unless one of these exceptions apply:
  % endif
  
  * Marriage
  * Religious beliefs
  * Status as a victim of trafficking
  * **{Gender-related identity}**

  These can be Illinois registries or similar registries in any other state.
fields:
  - no label: x[i].registry
    datatype: yesnoradio
  - Which of these exceptions apply?: x[i].registry_exceptions
    datatype: checkboxes
    choices:
      - Marriage: Marriage 
      - Religious beliefs: Religious beliefs
      - Status as a victim of trafficking: Status as a victim of trafficking
      - Gender-related identity: Gender-related identity
    show if:
      variable: x[i].registry
      is: True
---
terms:
  - "Gender-related identity": |
      The Illinois Human Rights Act states that gender-identity does not need to be the same as the  sex designated at birth.
  - "Offenses requiring registration": |
      These include crimes that require registration under the:
  
       * Sex Offender Registration Act
       * Murderer and Violent Offender Against Youth Act, or
       * Arsonist Registration Act.
---
id: registry kickout
event: registry_kickout
question: |
  Sorry
subquestion: |
  A person who committed crimes that require registration and is not pardoned cannot request a name change with this program. It may result in a felony.
  
  These include crimes that require registration under the:
  
  * Sex Offender Registration Act
  * Murderer and Violent Offender Against Youth Act, or
  * Arsonist Registration Act.
  
  Click **Back** if you made a mistake. Or you can talk with a lawyer to discuss your options. Use **[Get Legal Help](https://www.illinoislegalaid.org/get-legal-help)** to find free or low-cost legal services in your area.
buttons:
  - Exit: exit
  - Restart: restart
---
id: spouse registry kickout
continue button field: spouse_registry_kickout
question: |
  Sorry
subquestion: |
  A person who committed crimes that require registration and is not pardoned cannot request a name change with this program. It may result in a felony.
  
  These include crimes that require registration under the:
  
  * Sex Offender Registration Act
  * Murderer and Violent Offender Against Youth Act, or
  * Arsonist Registration Act.
  
  This program cannot make name change forms for your spouse. You can talk with a lawyer to discuss your options. Use **[Get Legal Help](https://www.illinoislegalaid.org/get-legal-help)** to find free or low-cost legal services in your area.
  
  Click **Back** if you made a mistake or click **Next** to make the forms for your name change.
---
depends on: users[1].registry_exceptions
code: |
  if change_spouse_name == "Yes" and (users[1].registry and users[1].registry_exceptions.all_false()):
    change_spouse_name = "No"
  spouse_registry_eligibility_check = True
---
id: registry notification requirement info
continue button field: registry_notification
question: |
  Notify law enforcement after a name change if required to register
subquestion: |
  Anyone who is required to register and is granted a legal name change must notify the law enforcement agency with whom they are registered of the name change.

  Notification deadlines depend on the type of registration:

  * Sex Offender Registration Act - notify within 3 days
  * Murderer and Violent Offender Against Youth Act - notify within 5 days
  * Arsonist Registration Act - notify within 10 days
---
id: id theft
generic object: ALPeopleList
question: |
  % if interview_type == 'adult':
    % if i == 0:
    Do you have any convictions or were you placed on probation for identity theft?
    % else:
    Does your spouse have any convictions or were they placed on probation for identity theft?
    % endif
  % else:
  Does ${x[i].new.name.full(middle='full')} (AKA ${x[i].name.full(middle='full')}) have any convictions or were they placed on probation for identity theft?
  % endif
subquestion: |
  This includes **identity theft** or **aggravated identity theft**.
  
  These can be in Illinois or any other state.

  % if interview_type == 'adult':
    % if i == 0:
    You can still request a name change even if you answer **Yes**.
    % else:
    Your spouse can still request a name change even if you answer **Yes**.
    % endif
  % else:
  You can still request a name change for ${x[i].new.name.full(middle='full')} (AKA ${x[i].name.full(middle='full')}) even if you answer **Yes**.
  % endif
fields:
  - no label: x[i].id_theft
    datatype: yesnoradio
---
id: conviction intro
generic object: ALPeopleList
continue button field: x[i].conviction_intro
question: |
  Criminal history details
subquestion: |
  % if interview_type == 'adult':
    % if i == 0:
    For these convictions or probations, you must enter more information on your name change request:
    % else:
    For these convictions or probations, you must enter more information on your spouse's name change request:
    % endif
  % else:
  For these convictions or probations of ${x[i].new.name.full(middle='full')} (AKA ${x[i].name.full(middle='full')}), you must enter more information:
  % endif

  % if x[i].felonies:
   * Felony convictions or probations
  % endif
  % if x[i].registry:
   * **{Offenses requiring registration}**
  % endif
  % if x[i].id_theft:
   * Identification theft or Aggravated identity theft
  % endif

---
id: conviction details
generic object: ALPeopleList
question: |
  % if j == 0:
  Conviction or probation details
  % else:
  More conviction or probation details
  % endif
subquestion: |
  % if interview_type == 'adult':
    % if i == 0:
    For any of the following convictions or probations, you must enter more information on your name change request:
    % else:
    For any of the following convictions or probations, you must enter more information on your spouse's name change request:
    % endif
  % else:
  For any of the following convictions or probations of ${x[i].new.name.full(middle='full')} (AKA ${x[i].name.full(middle='full')}), you must enter more information:
  % endif
  
  % if x[i].felonies:
   * Felony convictions or probations
  % endif
  % if x[i].registry:
   * **{Offenses requiring registration}**
  % endif
  % if x[i].id_theft:
   * Identification theft or Aggravated identity theft
  % endif
fields:
  - Offense description: x[i].convictions[j].name.text
    maxlength: 30
  - Date of conviction or probation: x[i].convictions[j].date
    datatype: date
    max: ${ today().format("yyyy-MM-dd") }
  - Sentence received: x[i].convictions[j].sentence
    maxlength: 30
  - Date sentence completed: x[i].convictions[j].completed_date
    datatype: date
    max: ${ today().format("yyyy-MM-dd") }
  - Pardoned?: x[i].convictions[j].pardoned
    datatype: yesnoradio
validation code: |
  if x[i].convictions[j].completed_date < x[i].convictions[j].date:
    validation_error("Date sentence completed must be on or after date of conviction or probation. Please adjust your answers.", field="x[i].convictions[j].completed_date")

---
id: any other convictions
generic object: ALPeopleList
question: |
  Are there other convictions or probations?
subquestion: |
  % if interview_type == 'adult':
    % if i == 0:
    For any of the following convictions or probations, you must enter more information on your name change request:
    % else:
    For any of the following convictions or probations, you must enter more information on your spouse's name change request:
    % endif
  % else:
  For these convictions or probations of ${x[i].new.name.full(middle='full')} (AKA ${x[i].name.full(middle='full')}), you must enter more information on your name change request:
  % endif

  % if x[i].felonies:
   * Felony convictions or probations
  % endif
  % if x[i].registry:
   * **{Offenses requiring registration}**
  % endif
  % if x[i].id_theft:
   * Identification theft or Aggravated identity theft
  % endif
  
  % if x[i].convictions.number() == 1:
  You can enter up to 17 convictions or probations in total. So far you have told us about ${ x[i].convictions.number() } offense:
  % else:
  You can enter up to 17 convictions or probations in total. So far you have told us about ${ x[i].convictions.number() } offenses:
  % endif
  
  % for conviction in x[i].convictions:
   * ${conviction.name.text} on ${conviction.date}
  % endfor
fields:
  - "Add another conviction or probation?": x[i].convictions.there_is_another
    datatype: yesnoradio
---
code: |
  if users[0].convictions.number_gathered() >= 17:
    users[0].convictions.there_is_another = False
---
code: |
  #not sure if the change_spouse_name check is needed - will test
  #if change_spouse_name == "Yes":
  if users[1].convictions.number_gathered() >= 17:
    users[1].convictions.there_is_another = False
---
id: notice intro
continue button field: notice_intro
question: |
  Notice and publication
subquestion: |
  Name changes in Illinois usually require publishing a notice in the newspaper for 3 weeks to let others know.
  
  Publication can be skipped if:
  
   * The person requesting a name change is worried about their health or safety, or
   * The person requesting a name change was recently divorced and has not yet changed their name.
 
---
id: request waiver
question: |
  Are you worried that publishing your name change request in the newspaper would be a hardship?
subquestion: |
  You can ask the judge to skip publication of the name change if it would be a hardship on the person asking for a name change. A hardship could include harm to health or safety.
fields:
  - no label: request_waiver
    datatype: radio
    choices:
      - Yes, I want to ask the court to waive publication.: True
      - No, I am okay with newspaper publication.: False
---
id: publication waiver reasons
question: |
  Why do you need a waiver?
subquestion: |
  % if interview_type == 'adult':
  You may need a waiver if you have or did have protection from a court order. You may also need a waiver if publication would be a hardship for the person whose name would be changed.
  % else:
    % if children.number_gathered() == 1:
    You may need a waiver if you have or did have protection from a court order. You may also need a waiver if publication would be a hardship for the child whose name would be changed.
    % else:
    You may need a waiver if you have or did have protection from a court order. You may also need a waiver if publication would be a hardship for the children whose names would be changed.
    % endif
  % endif
  
  A hardship can be many things. It can include fear of:
  
  * Physical violence,
  * Discrimination,
  * Harassment,
  * Bullying, or
  * Threats of violence.
fields:
  - no label: waiver_reason
    datatype: checkboxes
    minlength: 1
    choices:
      - I have or did have protection from a court order.: order
      - Publishing notice in a newspaper would be a hardship for the person who is changing their name.: hardship
    validation messages:
      minlength: |
        Please select at least one or click < Back if none apply.
---
id: protective order type
question: |
  What kind of court protection do or did you have?
subquestion: |
  You can enter details about the order on another screen.

  If you do any of these kinds of orders, you can click **Back** and change your answer.
fields:
  - I have or did have protection from: protective_order
    datatype: checkboxes
    minlength: 1
    none of the above: False
    choices:
      - An Order of Protection: op
      - A Stalking No Contact Order: snco
      - A Civil No Contact Order: cnco
      - A Protective order in someone else's criminal case: other_criminal
      - Being a protected person under someone else's bail conditions: bail
      - A similar protective order outside Illinois: other_order
    validation messages:
      minlength: |
        Please select at least one or click < Back if none apply.
  - In which state was the protective order? (not Illinois): other_order_state
    maxlength: 25
    show if:
      variable: protective_order['other_order']
      is: True
---
id: hardship text
question: |
  % if interview_type == "child":
    % if child_notice_would_be_published == True:
    Explain why publication would be a hardship (optional)
    % else:
    Explain why giving notice would be a hardship (optional)
    % endif
  % else:
  Explain why notice and publication would be a hardship (optional)
  % endif
subquestion: |  
  % if interview_type == "child":
    % if child_notice_would_be_published == True:
    There can be other reasons why notice by publication may be a hardship. For example, paying newspaper publication fees.
    % else:
    There can be other reasons why notice may be a hardship. 
    % endif
  % else:
  There can be other reasons why notice and publication may be a hardship. For example, paying newspaper publication fees.
  % endif
  
  This is optional. Your answers so far are enough for a judge to grant your request to waive notice and publication. They will go into your forms. Sometimes it is helpful to explain your hardship in your own words.
  
  % if interview_type == "child":
  ${collapse_template(child_notice_waiver_example)}
  % else:
  ${collapse_template(adult_notice_waiver_example)}
  % endif

fields:
  - Notice and publication would be a hardship because (optional):: hardship_text
    input type: area
    rows: 10
    maxlength: 500
    required: False
---
template: child_notice_waiver_example
subject: |
  **What should my answer look like?**
content: |  
  % if children.number_gathered() == 1:
  This explanation will go on your *Motion to Waive Notice and Publication*. You should explain why giving or publishing notice would put ${children[0].new.name.full(middle='full')} (AKA ${children[0].name.full(middle='full')}) at risk of physical harm or discrimination.
  % else:
  This explanation will go on your *Motion to Waive Notice and Publication*. You should explain why giving or publishing notice would put your children at risk of physical harm or discrimination.
  % endif

  Here are some examples: 
  
  "I need to change ${children[0].name.full(middle='full')}'s name to ${children[0].new.name.full(middle='full')} because we are trying to get away from my ex-boyfriend. He has abused ${children[0].name.full(middle='full')} in the past. I am afraid he will hurt ${children[0].name.full(middle='full')} if he learns about this name change request."
  
  "${children[0].name.full(middle='full')} wants to change their name to ${children[0].new.name.full(middle='full')} as part of a gender transition. I am afraid publishing notice of this change in the newspaper could lead to my child and I experiencing discrimination or targeted harassment."
---
template: adult_notice_waiver_example
subject: |
  **What should my answer look like?**
content: |  
  This explanation will go on your *Motion to Waive Notice and Publication*. You can explain why publishing your name change request in the newspaper would put you at risk or why it would be a hardship.
  
  Example: "I need a name change because I am trying to get away from my ex-boyfriend. He has abused me in the past. I am afraid he will hurt me if he learns about my name change request."

---
id: protective order details
question: |
  % if i == 0:
  Protective order case details
  % else:
  More protective order case details
  % endif
subquestion: |
  For any of the following, enter more information to your *Motion to Waive Notice and Publication*:
  
  % if protective_order['op']:
   * An Order of Protection
  % endif
  % if protective_order['snco']:
   * A Stalking No Contact Order
  % endif
  % if protective_order['cnco']:
   * A Civil No Contact Order
  % endif
  % if protective_order['other_criminal']:
   * A Protective order in someone else's criminal case
  % endif
  % if protective_order['bail']:
   * Being a protected person under someone else's bail conditions
  % endif
  % if protective_order['other_order']:
   * A similar protective order outside Illinois
  % endif
fields:
  - Case number: orders[i].number
    maxlength: 30
  - County: orders[i].name.text
    maxlength: 30
  - State: orders[i].state
    code: |
      states_list()
    default: IL      
---
id: any other orders
question: |
  Are there other protective order cases?
subquestion: |
  To waive notice and publication in the name change request, you must add details about the following cases:
  
  % if protective_order['op']:
   * An Order of Protection
  % endif
  % if protective_order['snco']:
   * A Stalking No Contact Order
  % endif
  % if protective_order['cnco']:
   * A Civil No Contact Order
  % endif
  % if protective_order['other_criminal']:
   * A Protective order in someone else's criminal case
  % endif
  % if protective_order['bail']:
   * Being a protected person under someone else's bail conditions
  % endif
  % if protective_order['other_order']:
   * A similar protective order outside Illinois
  % endif
  
  You can enter up to 4 cases. So far you have told us about:
  
  % for order in orders:
   * Case number: ${order.number} in ${order.name.text}, ${order.state}
  % endfor
fields:
  - "Add another case?": orders.there_is_another
    datatype: yesnoradio
---
code: |
  orders[i].name.text
  orders[i].complete = True
---
code: |
  if orders.number_gathered() >= 4:
    orders.there_is_another = False
---
id: publication intro
continue button field: publication_intro
question: |
  Information about publication
subquestion: |
  At the end of this program, you can download a *Publication Notice of Court Date for Request for Name Change*. 
  
  You will have to publish this in a newspaper in the county where you live once a week for 3 weeks in a row. There may be a publication fee to put your notice in the newspaper.
  
  Your notice must have details about when your name change request will be in court. This includes a hearing date that the court clerk will give you. When you get the hearing date, **ask for a date 6-8 weeks in the future** so you have plenty of time to set up the newspaper publication.

  % if interview_type == "adult":
  You can learn more from the "How to Change Your Name" instructions you can download at the end of this program.
  % else:
  You can learn more from the "How to Change Children's Names" instructions you can download at the end of this program.
  % endif
---
id: publication placeholder
continue button field: publication_placeholder
question: |
  Publication placeholder
subquestion: |
  When you file your name change request, the clerk should give you details about the court date. 
  
  Add the court hearing date, time, and how to attend court to the *Publication Notice of Court Date for Request for Name Change*.
  
  **Note:** These sections need to be complete before the newspaper can publish the notice.
  
  [FILE name_change_court_date.png, 100%, Court Date Information section of Publication notice]

  [FILE name_change_hearing_details.png, 100%, How to Attend Hearing section of Publication notice]

---
id: trial court county
continue button field: case_county
question: |
  In which county will you file the name change?
fields:
  - no label: trial_court_index
    datatype: integer
    code: |
      court_county_lookup()
---
code: |
  def court_county_lookup(lowercase=False):
    all_court_counties = court_list._load_courts()['address_county'].items()
    filtered_courts = [(-1, "cook")] if lowercase else [(-1, "Cook")]
    for court in all_court_counties:
      if court[1] != "Cook":
        court_name = court[1].lower() if lowercase else court[1]
        filtered_courts.append((court[0],court_name))
    return sorted( filtered_courts, key=lambda y: y[1])
---
depends on:
  - trial_court_index
code: |
  if trial_court_index == -1:
    trial_court = court_list.as_court('trial_court', 15)
    trial_court.address.county = "Cook"
  else:
    trial_court = court_list.as_court('trial_court', trial_court_index)
---
id: hide address
question: |
  Do you want to keep your address hidden?
subquestion: |
  You do not need to list your address on your court papers if this would put you or your household at risk.
  
  You can use an address where you can receive court notices instead.
field: hide_address
choices:
  - Yes: True
  - No: False
---
id: get address
question: |
  % if hide_address:
  What is your mailing address?
  % else:
  What is your home address?
  % endif
subquestion: |
  % if hide_address:
  **This address will appear on your court papers.** You may receive court notices and documents about your case at this address.
  % else:
  **This address will appear on your court papers.** If you do not want this, click **Back** to keep your address hidden.
  % endif
fields:
  - Street address: users[0].address.address
    address autocomplete: True
  - Address line 2: users[0].address.unit
    required: False
  - City: users[0].address.city
  - State: users[0].address.state
    code: |
      states_list()
    default: IL      
  - ZIP code: users[0].address.zip
---
id: get spouse address
question: |
  What is your spouse's address?
subquestion: |
fields:
  - Street address: users[1].address.address
    address autocomplete: True
  - Address line 2: users[1].address.unit
    required: False
  - City: users[1].address.city
  - State: users[1].address.state
    code: |
      states_list()
    default: IL      
  - ZIP code: users[1].address.zip
---
id: phone number
question: |
  What is your phone number?
subquestion: |
  If you do not want to list your phone number on your forms, leave this blank.
fields:
  - Phone: users[0].phone_number
    datatype: al_international_phone
    required: False
---
id: spouse phone number
question: |
  What is your spouse's phone number?
subquestion: |
  If you do not want to list their phone number on your forms, leave this blank.
fields:
  - Spouse's phone: users[1].phone_number
    datatype: al_international_phone
    required: False
---
id: notice by email
question: |
  Do you have an email address?
subquestion: |
  If you have an email address, you must list it so the court clerk can contact you about this case.
fields:
  - "Email?": users[0].email_notice
    datatype: yesnoradio
---
id: spouse notice by email
question: |
  Does your spouse have an email address?
subquestion: |
  If your spouse has an email address, you must list it so the court clerk can contact them about this case.
fields:
  - "Spouse email?": users[1].email_notice
    datatype: yesnoradio
---
id: email address
question: |
  What email address do you want to list on your court forms?
subquestion: |
  If you do not want to enter your personal email address, you can create a new email account to get email about your case.
  
  Be sure to check this email daily, otherwise you may miss important information about your case.
fields:
  - Email address: users[0].email    
    datatype: email
---
id: spouse email address
question: |
  What email address does your spouse want to list on the court forms?
subquestion: |
  If they do not want to enter their personal email address, they can create a new email account to get email about the case. 
  
  It is important to check this email daily or they may miss important information about the case.
fields:
  - Spouse's email address: users[1].email    
    datatype: email
---
id: e-signature
question: |
  Do you want to add your e-signature to your name change forms?
subquestion: |
  This program can put “**/s/ ${users[0].name.full(middle='full')}**” where you would sign your name. The court will accept this as your signature.

  If you do not add your **{e-signature}** now, you must sign your forms before you file them.

  ${ collapse_template(signature_help) }  
fields:
  - "Add e-signature?": e_signature
    datatype: yesnoradio
terms:
  - "e-signature": |
      An e-signature is an electronic signature. It is a digital version of a signature that has the same effect as a hand-written signature. 
---
template: signature_help
subject: |
  **What does it mean to sign the forms?**
content: |  
  By signing your forms, the person signing is certifying that:
  
  * Everything on the form is true and correct, and
  * They understand that making a false statement on the form is perjury, which can result in criminal penalties.
  
  See the [**Code of Civil Procedure, 735 ILCS 5/1-109**](https://www.ilga.gov/legislation/ilcs/documents/073500050k1-109.htm), for more information.
---
id: spouse e-signature
question: |
  Does your spouse want to add their e-signature to their name change forms?
subquestion: |
  This program can put “**/s/ ${users[1].name.full(middle='full')}**” where they would sign their name. The court will accept this as their signature.

  If they do not add their **{e-signature}** now, they must sign your forms before filing.

  ${ collapse_template(signature_help) }  
fields:
  - "Add spouse's e-signature?": e_signature_spouse
    datatype: yesnoradio
terms:
  - "e-signature": |
      An e-signature is an electronic signature. It is a digital version of a signature that has the same effect as a hand-written signature. 

---
depends on:
  - trial_court_index
  - cook_district
code: |
  if trial_court_index == -1:
    trial_court = court_list.as_court('trial_court', cook_district)
  else:
    trial_court = court_list.as_court('trial_court', trial_court_index)
    
  court_name = str(trial_court.name)
  court_street_address = str(trial_court.address.address)
  court_city = str(trial_court.address.city)
  court_state = str(trial_court.address.state)
  court_zip = str(trial_court.address.zip)
  courthouse_info = court_name + ", " + court_street_address + ", " + court_city + ", " + court_state + " " + court_zip
---
id: Cook County district
question: |
  In which Cook County court will you file your name change?
subquestion: |
  ${ collapse_template(cook_district_help) }  
field: cook_district
choices:
  - First Municipal District, Daley Center, 50 W. Washington Street, Chicago: 15
  - Second Municipal District, 5600 Old Orchard Road, Skokie: 16
  - Third Municipal District, 2121 Euclid Avenue, Rolling Meadows: 17
  - Fourth Municipal District, 1500 Maybrook Drive, Maywood: 18
  - Fifth Municipal District, 10220 S. 76th Avenue, Bridgeview: 19
  - Sixth Municipal District, 16501 South Kedzie Parkway, Markham: 20
---
template: cook_district_help
subject: |
  **What if I am not sure?**
content: |  
  Visit **[Illinois Court Help](https://www.ilcourthelp.gov/)**, or you can call or text (833) 411-1121 for assistance.
---
id: Cook County district 1 additional requirement
continue button field: district_1
question: |
  Cook County First Municipal District requirements
subquestion: |
  **Important note if filing a name change at the Daley Center:** You must e-file, as an exhibit, a photo or scanned copy of your birth certificate and a photo I.D. The exhibits must be saved as a PDF file and be in portrait orientation.
  
  If your birth certificate is in a language other than English, you must provide a certified translation of your birth certificate.
  
  Visit **[Illinois Court Help](https://www.ilcourthelp.gov/)**, or you can call or text (833) 411-1121 for assistance.
---
id: get docs screen
event: get_docs_screen
question: |
  Download
subquestion: |
  
  Your forms are ready. View and download your forms below. Click **Make changes** to fix any mistakes.

  This program **does not** file your forms with the court. You will need to do this yourself. Learn about [**e-filing in Illinois**](https://www.illinoiscourts.gov/eservices/efileil/).

  ${ action_button_html(url_action('review_answers'), label=':edit: Make changes', color='success', size="md") }
  
  ${ al_user_bundle.download_list_html() }

  &nbsp;

  ${ al_user_bundle.send_button_html(show_editable_checkbox=False) }

  **Note:** This program **does not** file your forms with the court. Learn about [**e-filing in Illinois**](https://www.illinoiscourts.gov/eservices/efileil/).
  
  Thank you for using ILAO Easy Forms!
under: |
  % if not user_logged_in():
  [${fa_icon("sign-in-alt", color="#0079d0", size="sm")} **Sign-in**](${url_of('login', next=interview_url())}) or [**create**](${url_of('register', next=interview_url())}) an ILAO Easy Form account to save your progress (optional).
  % endif 

  &nbsp;
  ${ action_button_html(interview_url(i="docassemble.ILAO:feedback.yml", easy_form_interview=ilao_easy_form_url, easy_form_title=ilao_easy_form_title, easy_form_page=user_info().question_id, easy_form_variable=user_info().variable, local=False,reset=1), label=':comment: Was this program helpful?', color="#181c36", size="md", new_window=True) }
---
generic object: ALDocumentBundle
template: x.send_email_template
subject: |
  Name change forms
content: |
  Your forms are attached.
  
  Thanks for using ILAO Easy Forms!
  
  [Illinois Legal Aid Online](https://www.illinoislegalaid.org)
---
objects:
  - instructions: ALDocument.using(title="Instructions", filename="instructions.pdf", has_addendum=False)
  - request: ALDocument.using(title="Request for name change", filename="request.pdf", has_addendum=False)
  - additional_criminal_history: ALDocument.using(title="Additional Criminal History", filename="name_change_additional_criminal_history.pdf", has_addendum=False)  
  - spouse_additional_criminal_history: ALDocument.using(title="Additional Criminal History", filename="name_change_additional_criminal_history.pdf", has_addendum=False)  
  - order: ALDocument.using(title="Order for name change", filename="order.pdf", has_addendum=False)
  - motion_to_waive_notice: ALDocument.using(title="Motion to Waive Notice and Publication", filename="motion_to_waive_notice.pdf", has_addendum=False)
  - order_to_waive_notice: ALDocument.using(title="Order to Waive Notice and Publication", filename="order_to_waive_notice.pdf", has_addendum=False)
  - publication_notice: ALDocument.using(title="Publication Notice", filename="publication_notice.pdf", has_addendum=False)
  - publication_notice_spouse: ALDocument.using(title="Publication Notice for spouse", filename="publication_notice_spouse.pdf", has_addendum=False)

---
code: |
  instructions.enabled = True
  request.enabled = True
  request_pdf_bundle.enabled = True
  additional_criminal_history.enabled = False
  spouse_additional_criminal_history.enabled = False
  order.enabled = True
  motion_to_waive_notice.enabled = False
  order_to_waive_notice.enabled = False
  publication_notice.enabled = False
  publication_notice_spouse.enabled = False

  if users[0].felonies or users[0].registry or users[0].id_theft:
    if users[0].convictions.number() > 3:
      additional_criminal_history.enabled = True
  if change_spouse_name == "Yes":    
    if users[1].felonies or users[1].registry or users[1].id_theft:
      if users[1].convictions.number() > 3:
        spouse_additional_criminal_history.enabled = True
    

  if request_waiver == True:  
    motion_to_waive_notice.enabled = True
    order_to_waive_notice.enabled = True

  if users[0].after_divorce == False:
    if request_waiver == False:
      publication_notice.enabled = True
      
    # should we add "and request_waiver == False" to this?  
    if change_spouse_name == "Yes":
      publication_notice_spouse.enabled = True

---
objects:
  - al_user_bundle: ALDocumentBundle.using(elements=[instructions, request_pdf_bundle, motion_to_waive_notice, order_to_waive_notice, publication_notice, publication_notice_spouse, order], filename="name_change_request.pdf", title="All forms")
  - al_court_bundle: ALDocumentBundle.using(elements=[request_pdf_bundle, motion_to_waive_notice, order_to_waive_notice, order], filename="name_change_request.pdf", title="Name change request")
---
objects:
  - request_pdf_bundle: ALDocumentBundle.using(elements=[request, additional_criminal_history, spouse_additional_criminal_history], filename="request.pdf", title="Request for name change")
---
attachment:
  variable name: instructions[i]
  name: instructions
  filename: instructions
  skip undefined: True
  editable: False
  pdf template file: instructions.pdf
  fields:
      - "fake": ${ "" }
---
attachment:
  variable name: request[i]
  name: request
  filename: request
  skip undefined: True
  editable: False
  pdf template file: name_change_request.pdf
  fields:
    - "trial_court_county": ${ trial_court.address.county.upper() }
    - "user__1": ${ users[0].name.full(middle="full") }
    - "user_name_first": ${ users[0].name.first }
    - "user_name_middle": ${ users[0].name.middle }
    - "user_name_last": ${ users[0].name.last }
    - "user_name_first_new": ${ users[0].new.name.first }
    - "user_name_middle_new": ${ users[0].new.name.middle }
    - "user_name_last_new": ${ users[0].new.name.last }
    - "user_resident_date": ${ users[0].resident_date }
    - "user_dob": ${ users[0].birthdate }
    - "user_birth_place": |
        % if users[0].in_america:
        ${ users[0].birthplace.city }, ${users[0].birthplace.county}, ${users[0].birthplace.state}, United States
        % else:
        % if users[0].birthplace.intl_text != "":
        ${ users[0].birthplace.city }, ${ users[0].birthplace.intl_text}, ${users[0].birthplace.country}
        % else:
        ${ users[0].birthplace.city }, ${users[0].birthplace.country}        
        % endif
        % endif
    - "user_divorce_no": ${ True if users[0].after_divorce == False else '' }
    - "user_divorce_yes": ${ True if users[0].after_divorce == True else '' }
    - "user_divorce_location": |
        % if users[0].after_divorce:
        ${ divorce_location.county }, ${divorce_location.state}
        % endif
    - "user_divorce_date": ${ divorce_date if users[0].after_divorce else '' }
    - "user_misdemeanor_yes": ${ True if users[0].misdemeanors == True else '' }
    - "user_misdemeanor_no": ${ True if users[0].misdemeanors == False else '' }
    - "user_pending_arrests_yes": ${ True if users[0].pending_arrests == True else '' }
    - "user_pending_arrests_no": ${ True if users[0].pending_arrests == False else '' }
    - "user_pending_charges_yes": ${ True if users[0].pending_charges == True else '' }
    - "user_pending_charges_no": ${ True if users[0].pending_charges == False else '' }
    - "user_felony_yes": ${ True if users[0].felonies == True else '' }
    - "user_felony_no": ${ True if users[0].felonies == False else '' }
    - "user_registry_yes": ${ True if users[0].registry == True else '' }
    - "user_registry_no": ${ True if users[0].registry == False else '' }
    - "user_registry_exception_marriage": ${ True if users[0].registry == True and users[0].registry_exceptions['Marriage'] == True else '' }
    - "user_registry_exception_religion": ${ True if users[0].registry == True and users[0].registry_exceptions['Religious beliefs'] == True else '' }
    - "user_registry_exception_victim": ${ True if users[0].registry == True and users[0].registry_exceptions['Status as a victim of trafficking'] == True else '' }
    - "user_registry_exception_gender": ${ True if users[0].registry == True and users[0].registry_exceptions['Gender-related identity'] == True else '' }
    - "user_id_theft_yes": ${ True if users[0].id_theft == True else '' }
    - "user_id_theft_no": ${ True if users[0].id_theft == False else '' }
    - "user_offense_name_1": ${ users[0].convictions[0].name.text }
    - "user_conviction_date_1": ${ format_date(users[0].convictions[0].date, format='MM/dd/yyyy') }
    - "user_sentence_1": ${ users[0].convictions[0].sentence }
    - "user_sentence_completed_date_1": ${ format_date(users[0].convictions[0].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_1": |
        % if users[0].convictions[0].name.text != "":
        % if users[0].convictions[0].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_2": ${ users[0].convictions[1].name.text }
    - "user_conviction_date_2": ${ format_date(users[0].convictions[1].date, format='MM/dd/yyyy') }
    - "user_sentence_2": ${ users[0].convictions[1].sentence }
    - "user_sentence_completed_date_2": ${ format_date(users[0].convictions[1].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_2": |
        % if users[0].convictions[1].name.text != "":
        % if users[0].convictions[1].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_3": ${ users[0].convictions[2].name.text }
    - "user_conviction_date_3": ${ format_date(users[0].convictions[2].date, format='MM/dd/yyyy') }
    - "user_sentence_3": ${ users[0].convictions[2].sentence }
    - "user_sentence_completed_date_3": ${ format_date(users[0].convictions[2].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_3": |
        % if users[0].convictions[2].name.text != "":
        % if users[0].convictions[2].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif

    - "spouse_name_first": ${ users[1].name.first if change_spouse_name == "Yes" else '' }
    - "spouse_name_middle": ${ users[1].name.middle if change_spouse_name == "Yes" else '' }
    - "spouse_name_last": ${ users[1].name.last if change_spouse_name == "Yes" else '' }
    - "spouse_name_first_new": ${ users[1].new.name.first if change_spouse_name == "Yes" else '' }
    - "spouse_name_middle_new": ${ users[1].new.name.middle if change_spouse_name == "Yes" else '' }
    - "spouse_name_last_new": ${ users[1].new.name.last if change_spouse_name == "Yes" else '' }
    - "spouse_resident_date": ${ users[1].resident_date if change_spouse_name == "Yes" else '' }
    - "spouse_dob": ${ users[1].birthdate if change_spouse_name == "Yes" else '' }
    - "spouse_birth_place": |
        % if users[1].in_america and change_spouse_name == "Yes":
        ${ users[1].birthplace.city }, ${users[1].birthplace.county}, ${users[1].birthplace.state}, United States
        % else:
        % if users[1].birthplace.intl_text != "" and change_spouse_name == "Yes":
        ${ users[1].birthplace.city }, ${ users[1].birthplace.intl_text}, ${users[1].birthplace.country}
        % else:
        ${ users[1].birthplace.city }, ${users[1].birthplace.country}        
        % endif
        % endif
    - "spouse_misdemeanor_yes": ${ True if users[1].misdemeanors == True and change_spouse_name == "Yes" else '' }
    - "spouse_misdemeanor_no": ${ True if users[1].misdemeanors == False and change_spouse_name == "Yes" else '' }
    - "spouse_pending_arrests_yes": ${ True if users[1].pending_arrests == True and change_spouse_name == "Yes" else '' }
    - "spouse_pending_arrests_no": ${ True if users[1].pending_arrests == False and change_spouse_name == "Yes" else '' }
    - "spouse_pending_charges_yes": ${ True if users[1].pending_charges == True and change_spouse_name == "Yes" else '' }
    - "spouse_pending_charges_no": ${ True if users[1].pending_charges == False and change_spouse_name == "Yes" else '' }
    - "spouse_felony_yes": ${ True if users[1].felonies == True and change_spouse_name == "Yes" else '' }
    - "spouse_felony_no": ${ True if users[1].felonies == False and change_spouse_name == "Yes" else '' }
    - "spouse_registry_yes": ${ True if users[1].registry == True and change_spouse_name == "Yes" else '' }
    - "spouse_registry_no": ${ True if users[1].registry == False and change_spouse_name == "Yes" else '' }
    
    - "spouse_registry_exception_marriage": ${ True if users[1].registry == True and users[1].registry_exceptions['Marriage'] == True and change_spouse_name == "Yes" else '' }
    - "spouse_registry_exception_religion": ${ True if users[1].registry == True and users[1].registry_exceptions['Religious beliefs'] == True and change_spouse_name == "Yes" else '' }
    - "spouse_registry_exception_victim": ${ True if users[1].registry == True and users[1].registry_exceptions['Status as a victim of trafficking'] == True and change_spouse_name == "Yes" else '' }
    - "spouse_registry_exception_gender": ${ True if users[1].registry == True and users[1].registry_exceptions['Gender-related identity'] == True and change_spouse_name == "Yes" else '' }
    - "spouse_id_theft_yes": ${ True if users[1].id_theft == True and change_spouse_name == "Yes" else '' }
    - "spouse_id_theft_no": ${ True if users[1].id_theft == False and change_spouse_name == "Yes" else '' }
    - "spouse_offense_name_1": ${ users[1].convictions[0].name.text }
    - "spouse_conviction_date_1": ${ format_date(users[1].convictions[0].date, format='MM/dd/yyyy') }
    - "spouse_sentence_1": ${ users[1].convictions[0].sentence }
    - "spouse_sentence_completed_date_1": ${ format_date(users[1].convictions[0].completed_date, format='MM/dd/yyyy') }
    - "spouse_pardoned_1": |
        % if users[1].convictions[0].name.text != "":
        % if users[1].convictions[0].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "spouse_offense_name_2": ${ users[1].convictions[1].name.text }
    - "spouse_conviction_date_2": ${ format_date(users[1].convictions[1].date, format='MM/dd/yyyy') }
    - "spouse_sentence_2": ${ users[1].convictions[1].sentence }
    - "spouse_sentence_completed_date_2": ${ format_date(users[1].convictions[1].completed_date, format='MM/dd/yyyy') }
    - "spouse_pardoned_2": |
        % if users[1].convictions[1].name.text != "":
        % if users[1].convictions[1].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "spouse_offense_name_3": ${ users[1].convictions[2].name.text }
    - "spouse_conviction_date_3": ${ format_date(users[1].convictions[2].date, format='MM/dd/yyyy') }
    - "spouse_sentence_3": ${ users[1].convictions[2].sentence }
    - "spouse_sentence_completed_date_3": ${ format_date(users[1].convictions[2].completed_date, format='MM/dd/yyyy') }
    - "spouse_pardoned_3": |
        % if users[1].convictions[2].name.text != "":
        % if users[1].convictions[2].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_signature": ${ users[0].name.full(middle="full") if e_signature else '' }
    - "user__2": ${ users[0].name.full(middle="full") }
    - "user_address": ${ users[0].address.on_one_line(bare=True) }
    - "user_hide_address_cb": ${ True if hide_address else '' }
    - "user_phone": ${ phone_number_formatted(users[0].phone_number) }
    - "user_atty_number": ${ '' }
    - "user_email": ${ users[0].email if users[0].email_notice else '' }
    - "spouse_signature": ${ users[1].name.full(middle="full") if e_signature_spouse and change_spouse_name == "Yes" else '' }
    - "spouse_name": ${ users[1].name.full(middle="full") if change_spouse_name == "Yes" else '' }
    - "spouse_address": ${ users[1].address.on_one_line(bare=True) if change_spouse_name == "Yes" else '' }
    - "spouse_phone": ${ phone_number_formatted(users[1].phone_number) if change_spouse_name == "Yes" else '' }
    - "spouse_atty_number": ${ '' }
    - "spouse_email": ${ users[1].email if users[1].email_notice and change_spouse_name == "Yes" else '' }
---
attachment:
  variable name: additional_criminal_history[i]
  name: addendum
  filename: addendum
  skip undefined: True
  editable: False
  pdf template file: name_change_additional_criminal_history.pdf
  fields:
    - "trial_court_county": ${ trial_court.address.county.upper() }
    - "user__1": ${ users[0].name.full(middle="full") }
    - "user_offense_name_4": ${ users[0].convictions[3].name.text }
    - "user_conviction_date_4": ${ format_date(users[0].convictions[3].date, format='MM/dd/yyyy') }
    - "user_sentence_4": ${ users[0].convictions[3].sentence }
    - "user_sentence_completed_date_4": ${ format_date(users[0].convictions[3].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_4": |
        % if users[0].convictions[3].name.text != "":
        % if users[0].convictions[3].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_5": ${ users[0].convictions[4].name.text }
    - "user_conviction_date_5": ${ format_date(users[0].convictions[4].date, format='MM/dd/yyyy') }
    - "user_sentence_5": ${ users[0].convictions[4].sentence }
    - "user_sentence_completed_date_5": ${ format_date(users[0].convictions[4].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_5": |
        % if users[0].convictions[4].name.text != "":
        % if users[0].convictions[4].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_6": ${ users[0].convictions[5].name.text }
    - "user_conviction_date_6": ${ format_date(users[0].convictions[5].date, format='MM/dd/yyyy') }
    - "user_sentence_6": ${ users[0].convictions[5].sentence }
    - "user_sentence_completed_date_6": ${ format_date(users[0].convictions[5].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_6": |
        % if users[0].convictions[5].name.text != "":
        % if users[0].convictions[5].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_7": ${ users[0].convictions[6].name.text }
    - "user_conviction_date_7": ${ format_date(users[0].convictions[6].date, format='MM/dd/yyyy') }
    - "user_sentence_7": ${ users[0].convictions[6].sentence }
    - "user_sentence_completed_date_7": ${ format_date(users[0].convictions[6].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_7": |
        % if users[0].convictions[6].name.text != "":
        % if users[0].convictions[6].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_8": ${ users[0].convictions[7].name.text }
    - "user_conviction_date_8": ${ format_date(users[0].convictions[7].date, format='MM/dd/yyyy') }
    - "user_sentence_8": ${ users[0].convictions[7].sentence }
    - "user_sentence_completed_date_8": ${ format_date(users[0].convictions[7].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_8": |
        % if users[0].convictions[7].name.text != "":
        % if users[0].convictions[7].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_9": ${ users[0].convictions[8].name.text }
    - "user_conviction_date_9": ${ format_date(users[0].convictions[8].date, format='MM/dd/yyyy') }
    - "user_sentence_9": ${ users[0].convictions[8].sentence }
    - "user_sentence_completed_date_9": ${ format_date(users[0].convictions[8].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_9": |
        % if users[0].convictions[8].name.text != "":
        % if users[0].convictions[8].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_10": ${ users[0].convictions[9].name.text }
    - "user_conviction_date_10": ${ format_date(users[0].convictions[9].date, format='MM/dd/yyyy') }
    - "user_sentence_10": ${ users[0].convictions[9].sentence }
    - "user_sentence_completed_date_10": ${ format_date(users[0].convictions[9].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_10": |
        % if users[0].convictions[9].name.text != "":
        % if users[0].convictions[9].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_11": ${ users[0].convictions[10].name.text }
    - "user_conviction_date_11": ${ format_date(users[0].convictions[10].date, format='MM/dd/yyyy') }
    - "user_sentence_11": ${ users[0].convictions[10].sentence }
    - "user_sentence_completed_date_11": ${ format_date(users[0].convictions[10].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_11": |
        % if users[0].convictions[10].name.text != "":
        % if users[0].convictions[10].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_12": ${ users[0].convictions[11].name.text }
    - "user_conviction_date_12": ${ format_date(users[0].convictions[11].date, format='MM/dd/yyyy') }
    - "user_sentence_12": ${ users[0].convictions[11].sentence }
    - "user_sentence_completed_date_12": ${ format_date(users[0].convictions[11].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_12": |
        % if users[0].convictions[11].name.text != "":
        % if users[0].convictions[11].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_13": ${ users[0].convictions[12].name.text }
    - "user_conviction_date_13": ${ format_date(users[0].convictions[12].date, format='MM/dd/yyyy') }
    - "user_sentence_13": ${ users[0].convictions[12].sentence }
    - "user_sentence_completed_date_13": ${ format_date(users[0].convictions[12].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_13": |
        % if users[0].convictions[12].name.text != "":
        % if users[0].convictions[12].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_14": ${ users[0].convictions[13].name.text }
    - "user_conviction_date_14": ${ format_date(users[0].convictions[13].date, format='MM/dd/yyyy') }
    - "user_sentence_14": ${ users[0].convictions[13].sentence }
    - "user_sentence_completed_date_14": ${ format_date(users[0].convictions[13].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_14": |
        % if users[0].convictions[13].name.text != "":
        % if users[0].convictions[13].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_15": ${ users[0].convictions[14].name.text }
    - "user_conviction_date_15": ${ format_date(users[0].convictions[14].date, format='MM/dd/yyyy') }
    - "user_sentence_15": ${ users[0].convictions[14].sentence }
    - "user_sentence_completed_date_15": ${ format_date(users[0].convictions[14].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_15": |
        % if users[0].convictions[14].name.text != "":
        % if users[0].convictions[14].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_16": ${ users[0].convictions[15].name.text }
    - "user_conviction_date_16": ${ format_date(users[0].convictions[15].date, format='MM/dd/yyyy') }
    - "user_sentence_16": ${ users[0].convictions[15].sentence }
    - "user_sentence_completed_date_16": ${ format_date(users[0].convictions[15].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_16": |
        % if users[0].convictions[15].name.text != "":
        % if users[0].convictions[15].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_17": ${ users[0].convictions[16].name.text }
    - "user_conviction_date_17": ${ format_date(users[0].convictions[16].date, format='MM/dd/yyyy') }
    - "user_sentence_17": ${ users[0].convictions[16].sentence }
    - "user_sentence_completed_date_17": ${ format_date(users[0].convictions[16].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_17": |
        % if users[0].convictions[16].name.text != "":
        % if users[0].convictions[16].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif

---
attachment:
  variable name: spouse_additional_criminal_history[i]
  name: spouse_addendum
  filename: spouse_addendum
  skip undefined: True
  editable: False
  pdf template file: name_change_additional_criminal_history.pdf
  fields:
    - "trial_court_county": ${ trial_court.address.county.upper() }
    - "user__1": ${ users[1].name.full(middle="full") }
    - "user_offense_name_4": ${ users[1].convictions[3].name.text }
    - "user_conviction_date_4": ${ format_date(users[1].convictions[3].date, format='MM/dd/yyyy') }
    - "user_sentence_4": ${ users[1].convictions[3].sentence }
    - "user_sentence_completed_date_4": ${ format_date(users[1].convictions[3].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_4": |
        % if users[1].convictions[3].name.text != "":
        % if users[1].convictions[3].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_5": ${ users[1].convictions[4].name.text }
    - "user_conviction_date_5": ${ format_date(users[1].convictions[4].date, format='MM/dd/yyyy') }
    - "user_sentence_5": ${ users[1].convictions[4].sentence }
    - "user_sentence_completed_date_5": ${ format_date(users[1].convictions[4].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_5": |
        % if users[1].convictions[4].name.text != "":
        % if users[1].convictions[4].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_6": ${ users[1].convictions[5].name.text }
    - "user_conviction_date_6": ${ format_date(users[1].convictions[5].date, format='MM/dd/yyyy') }
    - "user_sentence_6": ${ users[1].convictions[5].sentence }
    - "user_sentence_completed_date_6": ${ format_date(users[1].convictions[5].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_6": |
        % if users[1].convictions[5].name.text != "":
        % if users[1].convictions[5].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_7": ${ users[1].convictions[6].name.text }
    - "user_conviction_date_7": ${ format_date(users[1].convictions[6].date, format='MM/dd/yyyy') }
    - "user_sentence_7": ${ users[1].convictions[6].sentence }
    - "user_sentence_completed_date_7": ${ format_date(users[1].convictions[6].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_7": |
        % if users[1].convictions[6].name.text != "":
        % if users[1].convictions[6].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_8": ${ users[1].convictions[7].name.text }
    - "user_conviction_date_8": ${ format_date(users[1].convictions[7].date, format='MM/dd/yyyy') }
    - "user_sentence_8": ${ users[1].convictions[7].sentence }
    - "user_sentence_completed_date_8": ${ format_date(users[1].convictions[7].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_8": |
        % if users[1].convictions[7].name.text != "":
        % if users[1].convictions[7].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_9": ${ users[1].convictions[8].name.text }
    - "user_conviction_date_9": ${ format_date(users[1].convictions[8].date, format='MM/dd/yyyy') }
    - "user_sentence_9": ${ users[1].convictions[8].sentence }
    - "user_sentence_completed_date_9": ${ format_date(users[1].convictions[8].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_9": |
        % if users[1].convictions[8].name.text != "":
        % if users[1].convictions[8].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_10": ${ users[1].convictions[9].name.text }
    - "user_conviction_date_10": ${ format_date(users[1].convictions[9].date, format='MM/dd/yyyy') }
    - "user_sentence_10": ${ users[1].convictions[9].sentence }
    - "user_sentence_completed_date_10": ${ format_date(users[1].convictions[9].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_10": |
        % if users[1].convictions[9].name.text != "":
        % if users[1].convictions[9].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_11": ${ users[1].convictions[10].name.text }
    - "user_conviction_date_11": ${ format_date(users[1].convictions[10].date, format='MM/dd/yyyy') }
    - "user_sentence_11": ${ users[1].convictions[10].sentence }
    - "user_sentence_completed_date_11": ${ format_date(users[1].convictions[10].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_11": |
        % if users[1].convictions[10].name.text != "":
        % if users[1].convictions[10].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_12": ${ users[1].convictions[11].name.text }
    - "user_conviction_date_12": ${ format_date(users[1].convictions[11].date, format='MM/dd/yyyy') }
    - "user_sentence_12": ${ users[1].convictions[11].sentence }
    - "user_sentence_completed_date_12": ${ format_date(users[1].convictions[11].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_12": |
        % if users[1].convictions[11].name.text != "":
        % if users[1].convictions[11].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_13": ${ users[1].convictions[12].name.text }
    - "user_conviction_date_13": ${ format_date(users[1].convictions[12].date, format='MM/dd/yyyy') }
    - "user_sentence_13": ${ users[1].convictions[12].sentence }
    - "user_sentence_completed_date_13": ${ format_date(users[1].convictions[12].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_13": |
        % if users[1].convictions[12].name.text != "":
        % if users[1].convictions[12].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_14": ${ users[1].convictions[13].name.text }
    - "user_conviction_date_14": ${ format_date(users[1].convictions[13].date, format='MM/dd/yyyy') }
    - "user_sentence_14": ${ users[1].convictions[13].sentence }
    - "user_sentence_completed_date_14": ${ format_date(users[1].convictions[13].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_14": |
        % if users[1].convictions[13].name.text != "":
        % if users[1].convictions[13].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_15": ${ users[1].convictions[14].name.text }
    - "user_conviction_date_15": ${ format_date(users[1].convictions[14].date, format='MM/dd/yyyy') }
    - "user_sentence_15": ${ users[1].convictions[14].sentence }
    - "user_sentence_completed_date_15": ${ format_date(users[1].convictions[14].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_15": |
        % if users[1].convictions[14].name.text != "":
        % if users[1].convictions[14].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_16": ${ users[1].convictions[15].name.text }
    - "user_conviction_date_16": ${ format_date(users[1].convictions[15].date, format='MM/dd/yyyy') }
    - "user_sentence_16": ${ users[1].convictions[15].sentence }
    - "user_sentence_completed_date_16": ${ format_date(users[1].convictions[15].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_16": |
        % if users[1].convictions[15].name.text != "":
        % if users[1].convictions[15].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif
    - "user_offense_name_17": ${ users[1].convictions[16].name.text }
    - "user_conviction_date_17": ${ format_date(users[1].convictions[16].date, format='MM/dd/yyyy') }
    - "user_sentence_17": ${ users[1].convictions[16].sentence }
    - "user_sentence_completed_date_17": ${ format_date(users[1].convictions[16].completed_date, format='MM/dd/yyyy') }
    - "user_pardoned_17": |
        % if users[1].convictions[16].name.text != "":
        % if users[1].convictions[16].pardoned == True:
        Yes
        % else:
        No
        % endif
        % endif


---
attachment:
  variable name: motion_to_waive_notice[i]
  name: motion_to_waive_notice
  filename: motion_to_waive_notice
  skip undefined: True
  editable: False
  pdf template file: motion_to_waive_notice.pdf
  fields:      
    - "trial_court_county": ${ trial_court.address.county.upper() }
    - "user__1": ${ users[0].name.full(middle="full") }
    - "waiver_order_cb": ${ True if waiver_reason['order'] == True else '' }
    - "protective_order_op": ${ True if protective_order['op'] == True else '' }
    - "protective_order_snco": ${ True if protective_order['snco'] == True else '' }
    - "protective_order_cnco": ${ True if protective_order['cnco'] == True else '' }
    - "protective_order_criminal": ${ True if protective_order['other_criminal'] == True else '' }
    - "protective_order_bail": ${ True if protective_order['bail'] == True else '' }
    - "protective_order_other": ${ True if protective_order['other_order'] == True else '' }
    - "protective_order_other_state": ${ other_order_state if protective_order['other_order'] else '' }
    - "protective_order_minor_parent": ${ '' }
    - "waiver_hardship_cb": ${ True if waiver_reason['hardship'] == True else '' }
    - "hardship_text": ${ hardship_text }
    - "order_county_1": ${ orders[0].name.text if waiver_reason['order'] == True else '' }
    - "order_state_1": ${ orders[0].state if waiver_reason['order'] == True else '' }
    - "order_case_number_1": ${ orders[0].number if waiver_reason['order'] == True else '' }
    - "order_county_2": ${ orders[1].name.text if waiver_reason['order'] == True else '' }
    - "order_state_2": ${ orders[1].state if waiver_reason['order'] == True else '' }
    - "order_case_number_2": ${ orders[1].number if waiver_reason['order'] == True else '' }
    - "order_county_3": ${ orders[2].name.text if waiver_reason['order'] == True else '' }
    - "order_state_3": ${ orders[2].state if waiver_reason['order'] == True else '' }
    - "order_case_number_3": ${ orders[2].number if waiver_reason['order'] == True else '' }
    - "order_county_4": ${ orders[3].name.text if waiver_reason['order'] == True else '' }
    - "order_state_4": ${ orders[3].state if waiver_reason['order'] == True else '' }
    - "order_case_number_4": ${ orders[3].number if waiver_reason['order'] == True else '' }
    - "user_signature": ${ users[0].name.full(middle="full") if e_signature else '' }
    - "user__2": ${ users[0].name.full(middle="full") }
    - "user_address": ${ users[0].address.on_one_line(bare=True) }
    - "user_hide_address_cb": ${ True if hide_address else '' }
    - "user_phone": ${ phone_number_formatted(users[0].phone_number) }
    - "user_atty_number": ${ '' }
    - "user_email": ${ users[0].email if users[0].email_notice else '' }
---
attachment:
  variable name: publication_notice[i]
  name: publication_notice
  filename: publication_notice
  skip undefined: True
  editable: True
  pdf template file: publication_notice.pdf
  fields:
    - "trial_court_county": ${ trial_court.address.county.upper() }
    - "user__1": ${ users[0].name.full(middle="full") }
    - "user_name_first": ${ users[0].name.first }
    - "user_name_middle": ${ users[0].name.middle }
    - "user_name_last": ${ users[0].name.last }
    - "user_name_first_new": ${ users[0].new.name.first }
    - "user_name_middle_new": ${ users[0].new.name.middle }
    - "user_name_last_new": ${ users[0].new.name.last }
    - "courthouse_address": ${ courthouse_info }
    - "clerk_phone": ${ trial_court.phone }
    - "clerk_website": ${ trial_court.website }
    - "user_signature": ${ users[0].name.full(middle="full") if e_signature else '' }
    - "user__2": ${ users[0].name.full(middle="full") }
    - "user_address": ${ users[0].address.on_one_line(bare=True) }
    - "user_hide_address_cb": ${ True if hide_address else '' }
    - "user_phone": ${ phone_number_formatted(users[0].phone_number) }
    - "user_atty_number": ${ '' }
    - "user_email": ${ users[0].email if users[0].email_notice else '' }
---
attachment:
  variable name: publication_notice_spouse[i]
  name: publication_notice_spouse
  filename: publication_notice_spouse
  skip undefined: True
  editable: False
  pdf template file: publication_notice.pdf
  fields:
    - "trial_court_county": ${ trial_court.address.county.upper() }
    - "user__1": ${ users[1].name.full(middle="full") }
    - "user_name_first": ${ users[1].name.first }
    - "user_name_middle": ${ users[1].name.middle }
    - "user_name_last": ${ users[1].name.last }
    - "user_name_first_new": ${ users[1].new.name.first }
    - "user_name_middle_new": ${ users[1].new.name.middle }
    - "user_name_last_new": ${ users[1].new.name.last }
    - "courthouse_address": ${ courthouse_info }
    - "clerk_phone": ${ trial_court.phone }
    - "clerk_website": ${ trial_court.website }
    - "user_signature": ${ users[1].name.full(middle="full") if e_signature else '' }
    - "user__2": ${ users[1].name.full(middle="full") }
    - "user_address": ${ users[1].address.on_one_line(bare=True) }
    - "user_hide_address_cb": ${ '' }
    - "user_phone": ${ phone_number_formatted(users[1].phone_number) }
    - "user_atty_number": ${ '' }
    - "user_email": ${ users[0].email if users[1].email_notice else '' }
---
attachment:
  variable name: order[i]
  name: order
  filename: order
  skip undefined: True
  editable: False
  pdf template file: name_change_order.pdf
  fields:
    - "trial_court_county": ${ trial_court.address.county.upper() }
    - "user": ${ users[0].name.full(middle="full") }
---
attachment:
  variable name: order_to_waive_notice[i]
  name: order_to_waive_notice
  filename: order_to_waive_notice
  skip undefined: True
  editable: False
  pdf template file: order_to_waive_notice.pdf
  fields:
    - "trial_court_county": ${ trial_court.address.county.upper() }
    - "user": ${ users[0].name.full(middle="full") }


---
############### Review page
id: review screen
event: review_answers
question: |
  Review screen
subquestion: |
  Edit your answers below.
review: 
  - Edit: 
      - users[0].name.first
    button: |
      **Current legal name:**
      ${ users[0].name.full(middle="full") }
  - Edit: 
      - users[0].new.name.first
    button: |
      **New name:**
      ${ users[0].new.name.full(middle="full") }
  - Edit:
    - users[0].birthdate
    button: |
      **When were you born?**
      ${ users[0].birthdate }
  - Edit:
    - users[0].birthplace.city 
    button: |
      **Where were you born?**
      % if users[0].in_america:
      ${ users[0].birthplace.city }, ${ users[0].birthplace.county }, ${ users[0].birthplace.state }, US
      % else:
      ${ users[0].birthplace.city }, ${ users[0].birthplace.county }, ${ users[0].birthplace.country }
      % endif
  - Edit: 
      - users[0].is_resident
    button: |
      **Lived in Illinois for the past 6 months?**
      ${ word(yesno(users[0].is_resident)) }
  - Edit: 
      - users[0].resident_date
    button: |
      **Lived in Illinois since:**
      ${ users[0].resident_date }
  - Edit: hide_address
    button: |
      **Do you want to keep your address hidden?**
      ${ word(yesno(hide_address)) }
  - Edit: users[0].address.address
    button: |
      % if hide_address:
      **Your mailing address (will appear on your court papers):**
      % else:
      **Your home address:**
      % endif    
      ${ users[0].address.on_one_line(bare=True) }
  - Edit: users[0].phone_number
    button: |
      **Your phone number:**
      ${ phone_number_formatted(users[0].phone_number) }
  - Edit: users[0].email_notice
    button: |
      **Do you have an email address?**
      ${ word(yesno(users[0].email_notice)) }
  - Edit: users[0].email
    button: |
      **Your email:**
      ${ users[0].email }
    show if: users[0].email_notice
    
  - Edit: users[0].pending_arrests
    button: |
      **Do you have any arrests for which charges have not been filed?**
      ${ word(yesno(users[0].pending_arrests)) }
  - Edit: users[0].pending_charges
    button: |
      **Do you have any pending misdemeanor or felony charges?**
      ${ word(yesno(users[0].pending_charges)) }
  - Edit: users[0].misdemeanors
    button: |
      **Do you have any convictions or were you placed on probation for any misdemeanors?**
      ${ word(yesno(users[0].misdemeanors)) }
  - Edit: users[0].misdemeanors
    button: |
      **Were all of these misdemeanors pardoned?**
      ${ word(yesno(users[0].misdemeanor_pardon)) }
    show if: users[0].misdemeanors == True
  - Edit: users[0].felonies
    button: |
      **Do you have any convictions or were you placed on probation for any felonies?**
      ${ word(yesno(users[0].felonies)) }
  - Edit: users[0].felonies
    button: |
      **Were all of these felonies pardoned?**
      ${ word(yesno(users[0].felony_pardon)) }
    show if: users[0].felonies == True
  - Edit: users[0].registry
    button: |
      **Do you have any convictions or were you placed on probation for a crime that required you register?**
      ${ word(yesno(users[0].registry)) }
  - Edit: users[0].registry
    button: |
      **Name change exceptions to registry offenses:**
      
      % if users[0].registry_exceptions['Marriage']:
      * Marriage
      % endif
      % if users[0].registry_exceptions['Religious beliefs']:
      * Religious beliefs
      % endif
      % if users[0].registry_exceptions['Status as a victim of trafficking']:
      * Status as a victim of trafficking
      % endif
      % if users[0].registry_exceptions['Gender-related identity']:
      * Gender-related identity
      % endif
    show if: users[0].registry == True
  - Edit: users[0].id_theft
    button: |
      **Do you have any convictions or were you placed on probation for identity theft?**
      ${ word(yesno(users[0].id_theft)) }
  - Edit: users[0].convictions.revisit
    button: |
      **Convictions: (Edit to change details)**

      % for my_var in users[0].convictions:
        * ${ my_var.name.text } on ${ my_var.date }
      % endfor
    show if: users[0].felonies or users[0].registry or users[0].id_theft

  - Edit:
      - change_spouse_name
    button: |
      **Does your spouse want to change their name?**
      ${ showifdef('change_spouse_name') }
      &nbsp;
      
      **Note:** If you want to change this answer, the program works best if you start over.

  - Edit: 
      - users[1].name.first
    button: |
      **Spouse's current legal name:**
      ${ users[1].name.full(middle="full") }
    show if: change_spouse_name == 'Yes'
  - Edit: 
      - users[1].new.name.first
    button: |
      **Spouse's new name:**
      ${ users[1].new.name.full(middle="full") }
    show if: change_spouse_name == 'Yes'
  - Edit:
    - users[1].birthdate
    button: |
      **When was your spouse born?**
      ${ users[1].birthdate }
    show if: change_spouse_name == 'Yes'
  - Edit:
    - users[1].birthplace.city 
    button: |
      **Where was your spouse born?**
      % if users[1].in_america:
      ${ users[1].birthplace.city }, ${ users[1].birthplace.county }, ${ users[1].birthplace.state }, US
      % else:
      ${ users[1].birthplace.city }, ${ users[1].birthplace.county }, ${ users[1].birthplace.country }
      % endif
    show if: change_spouse_name == 'Yes'
  - Edit: 
      - users[1].is_resident
    button: |
      **Has your spouse lived in Illinois for the past 6 months?**
      ${ word(yesno(users[1].is_resident)) }
    show if: change_spouse_name == 'Yes'
  - Edit: 
      - users[1].resident_date
    button: |
      **Spouse lived in Illinois since:**
      ${ users[1].resident_date }
    show if: change_spouse_name == 'Yes'
  - Edit: users[1].address.address
    button: |
      **Your spouse's address:**
      ${ users[1].address.on_one_line(bare=True) }
    show if: change_spouse_name == 'Yes'
  - Edit: users[1].phone_number
    button: |
      **Your spouse's phone number:**
      ${ phone_number_formatted(users[1].phone_number) }
    show if: change_spouse_name == 'Yes'
  - Edit: users[1].email_notice
    button: |
      **Does your spouse have an email address?**
      ${ word(yesno(users[1].email_notice)) }
    show if: change_spouse_name == 'Yes'      
  - Edit: users[1].email
    button: |
      **Your spouse's email:**
      ${ users[1].email }
    show if: change_spouse_name == 'Yes' and users[1].email_notice

  - Edit: users[1].pending_arrests
    button: |
      **Does your spouse have any arrests for which charges have not been filed?**
      ${ word(yesno(users[1].pending_arrests)) }
  - Edit: users[1].pending_charges
    button: |
      **Does your spouse have any pending misdemeanor or felony charges?**
      ${ word(yesno(users[1].pending_charges)) }
  - Edit: users[1].misdemeanors
    button: |
      **Does your spouse have any convictions or were they placed on probation for any misdemeanors?**
      ${ word(yesno(users[1].misdemeanors)) }
  - Edit: users[1].misdemeanors
    button: |
      **Were all of these misdemeanors pardoned?**
      ${ word(yesno(users[1].misdemeanor_pardon)) }
    show if: users[1].misdemeanors == True
  - Edit: users[1].felonies
    button: |
      **Does your spouse have any convictions or were they placed on probation for any felonies?**
      ${ word(yesno(users[1].felonies)) }
  - Edit: users[1].felonies
    button: |
      **Were all of these felonies pardoned?**
      ${ word(yesno(users[1].felony_pardon)) }
    show if: users[1].felonies == True
  - Edit: users[1].registry
    button: |
      **Does your spouse have any convictions or were they placed on probation for a crime that required them to register?**
      ${ word(yesno(users[1].registry)) }
  - Edit: users[1].registry
    button: |
      **Name change exceptions to spouse's registry offenses:**
      
      % if users[1].registry_exceptions['Marriage']:
      * Marriage
      % endif
      % if users[1].registry_exceptions['Religious beliefs']:
      * Religious beliefs
      % endif
      % if users[1].registry_exceptions['Status as a victim of trafficking']:
      * Status as a victim of trafficking
      % endif
      % if users[1].registry_exceptions['Gender-related identity']:
      * Gender-related identity
      % endif
    show if: users[1].registry == True
  - Edit: users[1].id_theft
    button: |
      **Does your spouse have any convictions or were they placed on probation for identity theft?**
      ${ word(yesno(users[1].id_theft)) }
  - Edit: users[1].convictions.revisit
    button: |
      **Your spouse's convictions: (Edit to change details)**

      % for my_var in users[1].convictions:
        * ${ my_var.name.text } on ${ my_var.date }
      % endfor
    show if: users[1].felonies or users[1].registry or users[1].id_theft

  - Edit: 
      - users[0].after_divorce
    button: |
      **Are you changing your name as a result of a divorce?**
      ${ word(yesno(users[0].after_divorce)) }
  - Edit: 
      - divorce_date
    button: |
      **Divorce details**

      Date of divorce judgment: ${ showifdef('divorce_date') }

      County (or city if no county): ${ showifdef('divorce_location.county') }

      State or province: ${ showifdef('divorce_location.state') }
    show if: users[0].after_divorce == True
  - Edit: request_waiver
    button: |
      **Do you want to request a waiver of newspaper publication for your name change?**
      ${ word(yesno(request_waiver)) }
  - Edit: waiver_reason
    button: |
      **Why do you need a waiver?**
      
      % if waiver_reason['order']:
      * I have or did have protection from a court order.
      % endif
      % if waiver_reason['hardship']:
      * Publishing notice in a newspaper would be a hardship for the person who is changing their name.
      % endif
    show if: request_waiver == True
  - Edit: protective_order
    button: |
      **What kind of court protection do or did you have?**
      
      % if protective_order['op'] == True:
      * An Order of Protection
      % endif
      % if protective_order['snco'] == True:
      * A Stalking No Contact Order
      % endif
      % if protective_order['cnco'] == True:
      * A Civil No Contact Order
      % endif
      % if protective_order['other_criminal'] == True:
      * A protective order in someone else's criminal case
      % endif
      % if protective_order['bail'] == True:
      * Protection under someone else's bail conditions
      % endif
      % if protective_order['other_order'] == True:
      * A protective order in ${ other_order_state }
      % endif
    show if: request_waiver == True and waiver_reason['order'] == True
  - Edit: orders.revisit
    button: |
      **Protective orders: (Edit to change details)**

      % for my_var in orders:
        * ${ my_var.number } in ${ my_var.name.text }, ${ my_var.state }
      % endfor
    show if: request_waiver == True and waiver_reason['order'] == True
  - Edit: hardship_text
    button: |
      **Notice and publication would be a hardship because (optional):**
      ${ hardship_text }
    show if: request_waiver == True

  - Edit: 
      - trial_court_index
      - recompute:
        - trial_court
    button: |
      **County where you are filing your name change request:**
      ${ trial_court.address.county }
  - Edit: cook_district
    button: |
      **Cook County courthouse:**
      % if cook_district == "15":
      ${ "Daley Center, 50 W. Washington Street, Chicago" }
      % elif cook_district == "16":
      ${ "Second Municipal District, 5600 Old Orchard Road, Skokie" }
      % elif cook_district == "17":
      ${ "Third Municipal District, 2121 Euclid Avenue, Rolling Meadows" }
      % elif cook_district == "18":
      ${ "Fourth Municipal District, 1500 Maybrook Drive, Maywood" }
      % elif cook_district == "19":
      ${ "Fifth Municipal District, 10220 S. 76th Avenue, Bridgeview" }
      % elif cook_district == "20":
      ${ "Sixth Municipal District, 16501 South Kedzie Parkway, Markham" }
      % endif      
    show if: trial_court_index == -1      
  - Edit: e_signature
    button: |
      **Do you want to add your e-signature to your forms?**
      ${ word(yesno(e_signature)) }
  - Edit: e_signature_spouse
    button: |
      **Does your spouse want to add their e-signature to your forms?**
      ${ word(yesno(e_signature_spouse)) }
---
id: convictions revisit
continue button field: users[i].convictions.revisit
question: |
  Edit the convictions
subquestion: |
  ${ users[i].convictions.table }

  % if users[i].convictions.number_gathered() < 17:
  ${ users[i].convictions.add_action() }
  % endif
---
table: users[i].convictions.table
rows: users[i].convictions
columns:
  - Offense description: |
      row_item.name.text if defined("row_item.name.text") else ""
  - Details (including dates, sentences, and pardons): |
      action_button_html(url_action(row_item.attr_name("review_convictions_details")), label="Edit", icon="pencil-alt")
delete buttons: True
confirm: True
---
id: edit convictions
continue button field: x.review_convictions_details
generic object: DAObject
question: |
  Edit conviction details
review: 
  - Edit: x.name.text
    button: |
      **Offense description:**
      ${ x.name.text  }
  - Edit: x.date
    button: |
      **Date of conviction or probation:**
      ${ x.date } 
  - Edit: x.sentence
    button: |
      **Sentence received:**
      ${ x.sentence }
  - Edit: x.pardoned
    button: |
      **Pardoned?**
      ${ word(yesno(x.pardoned)) }
continue button label: Next
---
id: protective orders revisit
continue button field: orders.revisit
question: |
  Edit the protective orders
subquestion: |
  ${ orders.table }

  % if orders.number_gathered() < 4:
  ${ orders.add_action() }
  % endif
---
table: orders.table
rows: orders
columns:
  - Case number: |
      row_item.number if defined("row_item.name.text") else ""
  - County: |
      row_item.name.text if defined("row_item.name.text") else ""
  - State: |
      row_item.state if defined("row_item.name.text") else ""
edit:
  - name.text
delete buttons: True
confirm: True
---
id: about you review screen
section: About you
event: section_about_you
question: |
  About you
subquestion: |
  Edit your answers below.
review:
  - Edit: 
      - users[0].name.first
    button: |
      **Current legal name:**
      ${ users[0].name.full(middle="full") }
  - Edit: 
      - users[0].new.name.first
    button: |
      **New name:**
      ${ users[0].new.name.full(middle="full") }
  - Edit:
    - users[0].birthdate
    button: |
      **When were you born?**
      ${ users[0].birthdate }
  - Edit:
    - users[0].birthplace.city 
    button: |
      **Where were you born?**
      % if users[0].in_america:
      ${ users[0].birthplace.city }, ${ users[0].birthplace.county }, ${ users[0].birthplace.state }, US
      % else:
      ${ users[0].birthplace.city }, ${ users[0].birthplace.county }, ${ users[0].birthplace.country }
      % endif
  - Edit: 
      - users[0].is_resident
    button: |
      **Lived in Illinois for the past 6 months?**
      ${ word(yesno(users[0].is_resident)) }
  - Edit: 
      - users[0].resident_date
    button: |
      **Lived in Illinois since:**
      ${ users[0].resident_date }
  - Edit: hide_address
    button: |
      **Do you want to keep your address hidden?**
      ${ word(yesno(hide_address)) }
  - Edit: users[0].address.address
    button: |
      % if hide_address:
      **Your mailing address (will appear on your court papers):**
      % else:
      **Your home address:**
      % endif    
      ${ users[0].address.on_one_line(bare=True) }
  - Edit: users[0].phone_number
    button: |
      **Your phone number:**
      ${ phone_number_formatted(users[0].phone_number) }
  - Edit: users[0].email_notice
    button: |
      **Do you have an email address?**
      ${ word(yesno(users[0].email_notice)) }
  - Edit: users[0].email
    button: |
      **Your email:**
      ${ users[0].email }
    show if: users[0].email_notice
  - Edit: 
      - users[0].after_divorce
    button: |
      **Are you changing your name as a result of a divorce?**
      ${ word(yesno(users[0].after_divorce)) }

  - Edit: users[0].pending_arrests
    button: |
      **Do you have any arrests for which charges have not been filed?**
      ${ word(yesno(users[0].pending_arrests)) }
  - Edit: users[0].pending_charges
    button: |
      **Do you have any pending misdemeanor or felony charges?**
      ${ word(yesno(users[0].pending_charges)) }
  - Edit: users[0].misdemeanors
    button: |
      **Do you have any convictions or were you placed on probation for any misdemeanors?**
      ${ word(yesno(users[0].misdemeanors)) }
  - Edit: users[0].misdemeanors
    button: |
      **Were all of these misdemeanors pardoned?**
      ${ word(yesno(users[0].misdemeanor_pardon)) }
    show if: users[0].misdemeanors == True
  - Edit: users[0].felonies
    button: |
      **Do you have any convictions or were you placed on probation for any felonies?**
      ${ word(yesno(users[0].felonies)) }
  - Edit: users[0].felonies
    button: |
      **Were all of these felonies pardoned?**
      ${ word(yesno(users[0].felony_pardon)) }
    show if: users[0].felonies == True
  - Edit: users[0].registry
    button: |
      **Do you have any convictions or were you placed on probation for a crime that required you register?**
      ${ word(yesno(users[0].registry)) }
  - Edit: users[0].registry
    button: |
      **Name change exceptions to registry offenses:**
      
      % if users[0].registry_exceptions['Marriage']:
      * Marriage
      % endif
      % if users[0].registry_exceptions['Religious beliefs']:
      * Religious beliefs
      % endif
      % if users[0].registry_exceptions['Status as a victim of trafficking']:
      * Status as a victim of trafficking
      % endif
      % if users[0].registry_exceptions['Gender-related identity']:
      * Gender-related identity
      % endif
    show if: users[0].registry == True
  - Edit: users[0].id_theft
    button: |
      **Do you have any convictions or were you placed on probation for identity theft?**
      ${ word(yesno(users[0].id_theft)) }
  - Edit: users[0].convictions.revisit
    button: |
      **Convictions: (Edit to change details)**

      % for my_var in users[0].convictions:
        * ${ my_var.name.text } on ${ my_var.date }
      % endfor
    show if: users[0].felonies or users[0].registry or users[0].id_theft

  - Edit:
      - change_spouse_name
    button: |
      **Does your spouse want to change their name?**
      ${ showifdef('change_spouse_name') }
      &nbsp;
      
      **Note:** If you want to change this answer, the program works best if you start over.
---
id: about your spouse review screen
section: About your spouse (optional)
event: section_spouse
question: |
  About your spouse (optional)
subquestion: |
  Edit your answers below.
review:
  - Edit:
      - change_spouse_name
    button: |
      **Does your spouse want to change their name?**
      ${ showifdef('change_spouse_name') }
      &nbsp;
      
      **Note:** If you want to change this answer, the program works best if you start over.
  - Edit: 
      - users[1].name.first
    button: |
      **Spouse's current legal name:**
      ${ users[1].name.full(middle="full") }
    show if: change_spouse_name == 'Yes'
  - Edit: 
      - users[1].new.name.first
    button: |
      **Spouse's new name:**
      ${ users[1].new.name.full(middle="full") }
    show if: change_spouse_name == 'Yes'
  - Edit:
    - users[1].birthdate
    button: |
      **When was your spouse born?**
      ${ users[1].birthdate }
    show if: change_spouse_name == 'Yes'
  - Edit:
    - users[1].birthplace.city 
    button: |
      **Where was your spouse born?**
      % if users[1].in_america:
      ${ users[1].birthplace.city }, ${ users[1].birthplace.county }, ${ users[1].birthplace.state }, US
      % else:
      ${ users[1].birthplace.city }, ${ users[1].birthplace.county }, ${ users[1].birthplace.country }
      % endif
    show if: change_spouse_name == 'Yes'
  - Edit: 
      - users[1].is_resident
    button: |
      **Has your spouse lived in Illinois for the past 6 months?**
      ${ word(yesno(users[1].is_resident)) }
    show if: change_spouse_name == 'Yes'
  - Edit: 
      - users[1].resident_date
    button: |
      **Spouse lived in Illinois since:**
      ${ users[1].resident_date }
    show if: change_spouse_name == 'Yes'
  - Edit: users[1].address.address
    button: |
      **Your spouse's address:**
      ${ users[1].address.on_one_line(bare=True) }
    show if: change_spouse_name == 'Yes'
  - Edit: users[1].phone_number
    button: |
      **Your spouse's phone number:**
      ${ phone_number_formatted(users[1].phone_number) }
    show if: change_spouse_name == 'Yes'
  - Edit: users[1].email_notice
    button: |
      **Does your spouse have an email address?**
      ${ word(yesno(users[1].email_notice)) }
    show if: change_spouse_name == 'Yes'      
  - Edit: users[1].email
    button: |
      **Your spouse's email:**
      ${ users[1].email }
    show if: change_spouse_name == 'Yes' and users[1].email_notice

  - Edit: users[1].pending_arrests
    button: |
      **Does your spouse have any arrests for which charges have not been filed?**
      ${ word(yesno(users[1].pending_arrests)) }
  - Edit: users[1].pending_charges
    button: |
      **Does your spouse have any pending misdemeanor or felony charges?**
      ${ word(yesno(users[1].pending_charges)) }
  - Edit: users[1].misdemeanors
    button: |
      **Does your spouse have any convictions or were they placed on probation for any misdemeanors?**
      ${ word(yesno(users[1].misdemeanors)) }
  - Edit: users[1].misdemeanors
    button: |
      **Were all of these misdemeanors pardoned?**
      ${ word(yesno(users[1].misdemeanor_pardon)) }
    show if: users[1].misdemeanors == True
  - Edit: users[1].felonies
    button: |
      **Does your spouse have any convictions or were they placed on probation for any felonies?**
      ${ word(yesno(users[1].felonies)) }
  - Edit: users[1].felonies
    button: |
      **Were all of these felonies pardoned?**
      ${ word(yesno(users[1].felony_pardon)) }
    show if: users[1].felonies == True
  - Edit: users[1].registry
    button: |
      **Does your spouse have any convictions or were they placed on probation for a crime that required them to register?**
      ${ word(yesno(users[1].registry)) }
  - Edit: users[1].registry
    button: |
      **Name change exceptions to spouse's registry offenses:**
      
      % if users[1].registry_exceptions['Marriage']:
      * Marriage
      % endif
      % if users[1].registry_exceptions['Religious beliefs']:
      * Religious beliefs
      % endif
      % if users[1].registry_exceptions['Status as a victim of trafficking']:
      * Status as a victim of trafficking
      % endif
      % if users[1].registry_exceptions['Gender-related identity']:
      * Gender-related identity
      % endif
    show if: users[1].registry == True
  - Edit: users[1].id_theft
    button: |
      **Does your spouse have any convictions or were they placed on probation for identity theft?**
      ${ word(yesno(users[1].id_theft)) }
  - Edit: users[1].convictions.revisit
    button: |
      **Your spouse's convictions: (Edit to change details)**

      % for my_var in users[1].convictions:
        * ${ my_var.name.text } on ${ my_var.date }
      % endfor
    show if: users[1].felonies or users[1].registry or users[1].id_theft
---
id: notice and publication review screen
section: Notice and publication
event: section_notice
question: |
  Notice and publication
subquestion: |
  Edit your answers below.
review:
  - Edit: 
      - users[0].after_divorce
    button: |
      **Are you changing your name as a result of a divorce?**
      ${ word(yesno(users[0].after_divorce)) }
  - Edit: 
      - divorce_date
    button: |
      **Divorce details**

      Date of divorce judgment: ${ showifdef('divorce_date') }

      County (or city if no county): ${ showifdef('divorce_location.county') }

      State or province: ${ showifdef('divorce_location.state') }
    show if: users[0].after_divorce == True
  - Edit: request_waiver
    button: |
      **Do you want to request a waiver of newspaper publication for your name change?**
      ${ word(yesno(request_waiver)) }
  - Edit: waiver_reason
    button: |
      **Why do you need a waiver?**
      
      % if waiver_reason['order']:
      * I have or did have protection from a court order.
      % endif
      % if waiver_reason['hardship']:
      * Publishing notice in a newspaper would be a hardship for the person who is changing their name.
      % endif
    show if: request_waiver == True
  - Edit: protective_order
    button: |
      **What kind of court protection do or did you have?**
      
      % if protective_order['op'] == True:
      * An Order of Protection
      % endif
      % if protective_order['snco'] == True:
      * A Stalking No Contact Order
      % endif
      % if protective_order['cnco'] == True:
      * A Civil No Contact Order
      % endif
      % if protective_order['other_criminal'] == True:
      * A protective order in someone else's criminal case
      % endif
      % if protective_order['bail'] == True:
      * Protection under someone else's bail conditions
      % endif
      % if protective_order['other_order'] == True:
      * A protective order in ${ other_order_state }
      % endif
    show if: request_waiver == True and waiver_reason['order'] == True
  - Edit: orders.revisit
    button: |
      **Protective orders: (Edit to change details)**

      % for my_var in orders:
        * ${ my_var.number } in ${ my_var.name.text }, ${ my_var.state }
      % endfor
    show if: request_waiver == True and waiver_reason['order'] == True
  - Edit: hardship_text
    button: |
      **Notice and publication would be a hardship because (optional):**
      ${ hardship_text }
    show if: request_waiver == True

---
id: filing details review screen
section: Filing details
event: section_filing_details
question: |
  Filing details
subquestion: |
  Edit your answers below.
review:
  - Edit: 
      - trial_court_index
      - recompute:
        - trial_court
    button: |
      **County where you are filing your name change request:**
      ${ trial_court.address.county }
  - Edit: cook_district
    button: |
      **Cook County courthouse:**
      % if cook_district == "15":
      ${ "Daley Center, 50 W. Washington Street, Chicago" }
      % elif cook_district == "16":
      ${ "Second Municipal District, 5600 Old Orchard Road, Skokie" }
      % elif cook_district == "17":
      ${ "Third Municipal District, 2121 Euclid Avenue, Rolling Meadows" }
      % elif cook_district == "18":
      ${ "Fourth Municipal District, 1500 Maybrook Drive, Maywood" }
      % elif cook_district == "19":
      ${ "Fifth Municipal District, 10220 S. 76th Avenue, Bridgeview" }
      % elif cook_district == "20":
      ${ "Sixth Municipal District, 16501 South Kedzie Parkway, Markham" }
      % endif      
    show if: trial_court_index == -1      
  - Edit: e_signature
    button: |
      **Do you want to add your e-signature to your forms?**
      ${ word(yesno(e_signature)) }
  - Edit: e_signature_spouse
    button: |
      **Does your spouse want to add their e-signature to your forms?**
      ${ word(yesno(e_signature_spouse)) }
